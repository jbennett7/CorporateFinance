---
title: "Net Present Value and Other Investment Rules"
author: "Ross, Westerfield, Jaffe"
output:
  pdf_document:
    toc: true
    includes:
      in_header: preamble.tex
---

```{r setup, include=F}
require(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
pretty <- function(x, y=0) format(round(x, y), big.mark=",")
```

```{r Internal Rate of Return function, echo=F}
# I must be a negative initial investment.
# C must be positive cash flows.
irr <- function(I, C) {
  f <- function(r) I + sum(C/(1+r)^(1:length(C)))
  uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root
}
```

```{r Net present value, echo=F}
npv <- function(I, C, r) I + sum(C/(1 + r)^(1:length(C)))
```

# 5.1 Why use net present value?

\begin{tcolorbox}[title=\textbf{Capital budgeting},
    colback=red!5!white, colframe=red!75!white]
The decision-making process for accepting or rejecting projects.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Net present value},
    colback=red!5!white, colframe=red!75!white]
The value of future cash flows minus the present value of the cost of the
investment.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Example 5.1},
    colback=blue!5!white, colframe=blue!75!white]
\textbf{Net Present Value}
The Alpha Corporation is considering investing in a riskless project costing
\$100. The project receives \$107 in one year and has no other cash flows. The
riskless doscount rate is 6 percent.
\\\\
The NPV of the project can easily be calculated as:
\[
\$.94 = -\$100 + \frac{\$107}{1.06}
\]
From Chapter 4, we know that th eproject should be accepted because its NPV is
positive. Had the NPV of the project been negative, as would have been the case
with an interest rate greater than 7 percent, the project should be rejected.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{NPV investment rule},
    colback=orange!5!white, colframe=orange!75!white]
\begin{itemize}
  \item Accept a project if the NPV is greater than zero.
  \item Reject a project if NPT is less than zero.
\end{itemize}
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{NPV attributes},
    colback=orange!5!white, colframe=orange!70!white]
\begin{enumerate}
  \item NPV uses cash flows.
  \item NPV uses all the cash flows of the project.
  \item NPV discounts the cash flows properly.
\end{enumerate}
\end{tcolorbox}


# 5.2 The payback period method

The payback period rule for making investment decisions is simple. A particular
cutoff date, say two years, is selected. All investment projects that have
payback periods of two years or less are accepted, and all of those that pay off
in more than two years are rejected.

\begin{tcolorbox}[title=\textbf{Payback period example},
    colback=blue!5!white, colframe=blue!75!white]
Suppose a project has an initial investment of -\$50,000. The cash flows are
\$30,000, \$20,000, and \$10,000. If we choose a cutoff of two years, then the
project pays off in two years and thus we should accept the project.
\end{tcolorbox}

## Problems with the payback method

```{r Table 5.1; expected cash flows for projects, echo=F}
Year <- c(0, 1, 2, 3, 4)
A <- c(-100, 20, 30, 50, 60)
B <- c(-100, 50, 30, 20, 60)
C <- c(-100, 50, 30, 20, 60000)
knitr::kable(data.frame(Year, A, B, C),
    caption='Expected cash flows for projects A through C ($)')
```

\begin{tcolorbox}[
    title=\textbf{Problem 1: Timing of cash flows within the payback period},
    colback=orange!5!white, colframe=orange!75!white]
The payback method does not discount cash flows properly. In the table above, we
can see that all three projects have the same payback period of three years.
Therefore, all three would be identical if we use the payback period method of
choosing projects. However, because the large cash flow of \$50 comes earlier
for projects B and C, we know that those projects have a higher net present
value.
\end{tcolorbox}

\begin{tcolorbox}[
    title=\textbf{Problem 2: Payments after the payback period},
    colback=orange!5!white, colframe=orange!75!white]
Considering projects B and C we notice that project C has a rather large cash
flow in year 4 of \$60,000. However, if we used payback period, this cash flow
would not be included.
\end{tcolorbox}

\begin{tcolorbox}[
    title=\textbf{Problem 3: Arbitrary standard for payback period},
    colback=orange!5!white, colframe=orange!75!white]
There is no guide for choosing the payback cutoff date. It is completely
arbitrary.
\end{tcolorbox}

# 5.3 The discounted payback period

As an alternative we can use the discounted payback period method which does
discount the cash flows.

\begin{tcolorbox}[title=\textbf{Discounted payback period},
    colback=blue!5!white, colframe=blue!75!white]
Suppose that the discount rate is 10 percent and the cash flows on a project are
given by:

\[
(-\$100, \$50, \$50, \$20)
\]

This investment has a payback period of two years because the investment is paid
back in that time.
\\\\

To compute the project's discounted payback period, we first discount each of
the cash flows at the 10 percent rate. These discounted cash flows are:

\[
[-\$100, \$50/1.1, \$50(1.1)^2, \$20/(1.1)^3] =
    (-\$100, \$45.45, \$41.32, \$15.03)
\]

The discounted payback period of the original investment is simply the payback
period for these discounted cash flows. The payback period for the discounted
cash flows is slightly less than three years because the discounted cash flows
over the three years is \$101.80 (=\$45.45 + 41.32 + 15.03). As long as the cash
flows and discounted rate are positive, the discounted payback period will never
be smaller than the payback period because discounting reduces the value of the
cash flows.
\end{tcolorbox}

# 5.4 The internal rate of return

The appeal of the internal rate of return (IRR) is that it uses a single number
to summarize the merits of a project. This number does not depend on any outside
rate.

\begin{tcolorbox}[title=\textbf{Internal rate of return},
    colback=blue!5!white, colframe=blue!75!white]
Consider a simple project (-\$100, \$110). The net present value for this
project is

$$
\text{NPV} = -\$100 + \frac{\$110}{1 + R}
$$

where $R$ is the discount rate. The IRR method is used to find $R$.
\end{tcolorbox}

We can use `R`'s `uniroot` method to find this:

```{r 5.4 IRR example}
npv <- function(r) 110/(1 + r) - 100
uniroot(npv, c(0, 1))$root
```

We find the discount rate as .10.

We say that the project's internal rate of return is 10 percent. We compare this
number with the actual discount rate.

\begin{tcolorbox}[title=\textbf{Internal rate of return acceptance criteria},
    colback=orange!5!white, colframe=orange!75!white]
Accept the project if the IRR is greater than the discount rate. Reject the
project if the IRR is less than the discount rate.
\end{tcolorbox}

# 5.5 Problems with the IRR approach

\begin{tcolorbox}[title=\textbf{Independent project},
    colback=red!5!white, colframe=red!75!white]
A project whose acceptance or rejection is independent of the acceptance or
rejection of other projects.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{mutually exclusive investments},
    colback=red!5!white, colframe=red!75!white]
When investing in one project means you cannot invest in the other project.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Problem 1: Investing or financing?},
    colback=orange!5!white, colframe=orange!75!white]
Consider a project with cash flows (\$100, -\$130). In this situation the
positive cash flow comes first, and the payout is later. This usually happens
with projects where payment is done before receiving the good or service, such
as when buying tickets to a concert.
\\\\
In this situation we reverse the rule: Accept the project when the IRR is less
than the discount rate. Reject the project when the IRR is greater than the
discount rate.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Problem 2: Mutliple rates or return},
    colback=orange!5!white, colframe=orange!75!white]
Suppose that the cash flows from the project are (-\$100, \$230, -\$132). Here
we see that there are two sign changes. This means that the project will have
two IRRs, one is 10 percent and the other is 20 percent. In order to deal with
projects that have multiple rates of return we use the modified IRR.
\end{tcolorbox}


```{r 5.5 Problems with IRR; problem 3, echo=F}
df <- matrix(c(-1, -10, 1.5, 11, .5, 1.00, .5, .10), nrow=2)
colnames(df) <- c("CF1", "CF2", "NPV", "IRR")
rownames(df) <- c("Opportunity 1", "Opportunity 2")
knitr::kable(df)
```

\begin{tcolorbox}[title=\textbf{Problem 3: The scale problem},
    colback=orange!5!white, colframe=orange!75!white]
The table above illustrates a defect with the internal rate of return. The basic
IRR rule indicates the selection of Opportunity 1 because the IRR is 50 percent.
The IRR is only 10 percent for Opportunity 2. However, the net present value
for opportunity 2 is better.
\\\\
The problem with IRR is that it ignores issues of \textit{scale}. Although Opportunity
1 has a greater IRR, the investment is much smaller.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Example 5.2},
    colback=blue!5!white, colframe=blue!75!white]
\textbf{NPV versus IRR}
Stanley Jaffe and Sherry Lansing have just purchased the rights to Corporate
Finance: The Motion Picture. They will produce this major motion picture on
either a small budget or a big budget. Here are the estimated cash flows:
\end{tcolorbox}

```{r example 5.2; NPV versus IRR; setup, echo=F}
ex5.2 <- new.env()
ex5.2$df <- data.frame(
  cf.0 = c(-10, -25),
  cf.1 = c(40, 65),
  npv = c(22, 27),
  irr = c(300, 160)
)

row.names(ex5.2$df) <- c("Small budget", "Large budget")
colnames(ex5.2$df) <- c("Cash Flow at Date 0",
                        "Cash Flow at Date 1",
                        "NPV @25%",
                        "IRR")

knitr::kable(ex5.2$df)
```

\begin{tcolorbox}[colback=blue!5!white, colframe=blue!75!white]
Because of high risk, a 25 percent discount rate is considered appropriate.
Sherry wants to adopt the large budget because the NPV is higher. Stanley wants
to adopt the small budget because the IRR is higher. Who is right?

For the reasons espoused in the previous example, NPV is correct. Hence Sherry
is right. However, Stanley is very stubborn where IRR is concerned. How can
Sherry justify the large budget to Stanley using the IRR approach?

This is where incremental IRR comes in. Sherry calculaes the incremental cash
flows from choosing the large budget instead of the small budget as follows:

\begin{table}[H]
  \centering
  \begin{tabular}{lccc}
    \toprule
    & Cash Flow at Date 0 & Cash  Flow at Date 1\\
    Incremental cash flows & -\$25 - (-10) = -\$15 & \$65 - 40 = \$25\\
    \bottomrule
  \end{tabular}
\end{table}

This chart shows that the incremental cash flows are -\$15 million at Date 0 and
\$25 million at Date 1. Sherry calculates incremental IRR as follows:

\begin{centering}
\textbf{Formula for calculating the incremental IRR:}
\[
0 = -\$15\ \text{million} + \frac{\$25\ \text{million}}{1 + \text{IRR}}
\]
\end{centering}

IRR equals 66.67 percent in this equation, implying that the incremental IRR
is 66.67 percent. Incremental IRR is the IRR on the incremental investment from
choosing the larger project instead of the small project.

In addition, we can calculate the NPV of the incremental cash flows:

\begin{centering}
\textbf{NPV of incremental cash flows:}
\end{centering}

\[
-\$15\ \text{million} + \frac{\$25\ \text{million}}{1.25} = \$5\ \text{million}
\]

We know the small-budget picture would be acceptable as an independent project
because its NPV is positive. We want to know whether it is beneficial to invest
an additional \$15 million to make the large-budget picture instead of the
small-budget picture. In other words, is it beneficial to invest an additional
\$15 million to receive an additional \$25 million next year? First, our
calculations show the NPV on the incremental investment to be positive. Second,
the incremental IRR of 66.67 percent is higher than the discount rate of 25
percent. For both reasons, the incremental investment can be justified, so the
large-budget movie should be made. The second reason is what Stanley needed to
hear to be convinced.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Problem 4: The timing problem},
    colback=orange!5!white, colframe=orange!75!white]
Illustrated with the following example
\end{tcolorbox}

### Example 5.3

#### Mututally exclusive investments

Suppose that the Kaufold Corporation has two alternative uses for a warehouse.
It can store toxic waste containers (Investment A) or electronic equipment
(Investment B). The cash flows are as follows:

```{r example 5.3; mutually exclusive investments, echo=F}
ex5.3 <- new.env()
ex5.3$df <- matrix(pretty(c(-10000, -10000, 10000, 1000, 1000, 1000, 1000, 12000,
                     2000, 4000, 669, 751, 109, -484, 16.04, 12.94)), nrow=2)
row.names(ex5.3$df) <- c("Investment A", "Investment B")
colnames(ex5.3$df) <- c("CF 0", "CF 1", "CF 2", "CF 3",
                        "NPV @0%", "NPV @10%", "NPV @15%", "IRR")
knitr::kable(ex5.3$df)
```

We find that the NPV of Investment B is higher with low discount rates, and the
NPV of Investment A is higher with high discount rates. This is not surprising
if you look closely at the csh flow patterns. The cash flows of A occur early,
whereas the cash flows of B occur later. If we assume a high discount rate, we
favor Investment A because we are implicitly assuming that the early cash flow
(for example, \$10,000 in Year 1) can be reinvested at that rate. Because most
of Investment B's cash flows occur in Year 3, B's value is relatively high with
low discount rates.

# 5.6 The profitability index

The profitability index is the ratio of the present value of the future cash
flows _after_ initial investment divided by the amount of the initial
investment.

$$
\text{Profitability index (PI)} =
  \frac{\text{PV of cash flows subsequent to initial investment}}
       {\text{Initial investment}}
$$

### Example 5.4

#### Profitability index

Hiram Finnegan Inc. (HFI) applies a 12 percent discount rate to two investment
opportunities.

| Project | $C_0$ | $C_1$ | $C_2$ | PV @ 12% of CF | PI | NPV @12% |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| 1 | -\$20 | \$70 | \$10 | \$70.5 | 3.53 | \$50.5 |
| 2 | -\$10 | \$15 | \$10 | \$45.3 | 4.53 |   35.3 |

The profitability index for project 1 is calculated as such

$$
\$70.5 = \frac{\$70}{1.12} + \frac{\$10}{(1.12)^2}
$$

The profitability index is obtained by dividing this result by the initial
investment of \$20:

$$
3.53 = \frac{\$70.5}{\$20}
$$

## Application of the profitability index

### Independent projects

Assume that HFI's two projects are independent. According to the NPV rule, both
projects should be accepted because NPV is positive in each case. The
profitability index (PI) is greater than 1 whenever the NPV is positive. Thus,
the pI _decision rule_ is:

* Accept an independent project if PI > 1.

* Reject it if PI < 1.

### Mutually exclusive projects

Let us now assume that HFI can only accept one of its two projects. NPV analysis
says accept Project 1 because this project has the bigger NPV. 

### Capital rationing

Consider the case when the firm does not have enough capital to fund all
positive nPV projects.

# 5.7 The practice of capital budgeting

# Summary and conclusions

1. In this chapter, we covered different investment decision rules. We evaluated
   the most popular alternatives to the NPV: The payback period, the discounted
   payback period, the internal rate of return, and the profitability index. In
   doing so we learned more about the NPV.

2. While we found that the alternatives have some redeeming qualities, when all is said and done, they are not the NPV rule; for those of us in finance, that makes them decidedly second-rate.

3. Of the competitors to NPV, IRR must be ranked above payback. In fact, IRR always reaches the same decision as NPV in the normal case where the initial outflows of an independent investment project are followed only by a series of inflows.

4. We classified the flaws of IRR into two types. First, we considered the general case applying to both independent and mutually exclusive projects. There appeared to be two problems here:

> a. Some projects have cash inflows follwoed by one or more outflows. The IRR rule is inverted here: One should accept the IRR is _below_ the discount rate.
> b. Some projects have a number of changes of sign in their cash flows. Here, there are likely to be multiple internal rates of return. The practitioner must use either NPV or modified internal rate of return here.

5. Next, we considered the specific problems with the NPV for mutually exclusive projects. We showed that, due to differences in either size or timing, the project with the highest IRR need not have the highest NPV. Hence, the IRR rule should not be applied. (Of course, NPV can still be applied.)

6. We described capital rationing as the case where funds are limited to a fixed dollar amount. With capital rationing the profitability index is a useful method of adjusting the NPV.

# Concept Questions

## Payback period and net present value

If a project with conventional cash flows has a payback period less than the project's life, can you definitively state the algebraic sign of the NPV? Why or why not? If you know that the discounted payback period is less than the project's life, what can you say about the NPV? Explain.

A project's payback period is not enough to tell if the NPV will be positive (profitable project). This is because the payback period does not take into account the interest rate. However, if the discounted payback period is less than the project's life, then we can say that the NPV will be positive.

---

## Net present value

Suppose a project has conventional cash flows and a positive NPV. What do you know about its payback? Its discounted payback? Its profitability index? Its IRR? Explain.

If the project has conventional (positive) cash flows and a positive NPV, then we know the payback period will be less than the life of the project, its discounted payback will be less than the life of the project, its profitability index will be greater than 1, and its IRR will be greater than the discount rate. All of this means that the project should be accepted.

---

## Comparing investment criteria

Define each of the following investment rules and discuss any potential shortcomings of each. In your definition, state the criterion for accepting or rejecting independent projects under each rule.

a. Payback period.
b. Internal rate of return.
c. Profitability index.
d. Net present value.

### Payback period

The payback period defines how an investment should be viewed based on how long it takes for the investment to pay for itself. The issue with the payback period is that it does not take into account the time value of money as well as the cash flows after the payback period has lapsed. This makes it difficult to use when comparing multiple investment options because it doesn't take into account cash flows after the payback period.

A modified version of the payback period is the discounted payback period which does take into account the time value of money. However, it still does not take into account the cash flows after the payback period. The NPV method is better.

### Internal rate of return

The internal rate of return is a better method of evaluating an investment than the payback period. It calculates the investments interal rate, which can be used to compare with the discount rate. If the internal rate is greater than the discount rate the investment should be made. However, there are problems with the internal rate of return:

1. Some investments are inverted. Meaning that the investment has an initial inflow, followed by a sequence of outflows. In this case the IRR rule should be inverted: You should make the investment if the internal rate is less than the discount rate.

2. Sometimes there are a number of sign changes in the cash flows (i.e. there are additional investments that need to be made beside the initial investment). If this is the case there will be multiple internal rates of return. To compensate for this problem you can use the Modified IRR, which addresses the sign change issue by combining cash flows until only one sign change remains. The alternative is to use NPV.

The IRR also has an issue when trying to compare mutually exclusive investments due to scale and timing. The IRR does not take into account the scale of the investments; meaning that larger investments may generate larger cash flows even though the IRR may be lower. This can be compensated using Incremental IRR which uses the difference between the two investments when comparing. Timing of the cash flows can also affect the validity of the IRR. If larger cash flows occur later in the life of the investment, depending on the discount rate, the IRR may give the wrong decision.

### Profitability index

The profitability index is a useful way of comparing investments, however it does suffer from the same problems as the internal rate of return in terms of scaling. It can be compensated using incremental analysis.

### Net present value

The net present value is the most superior method in evaluating an investment. In all cases it will yield the right result. The net present value takes into account the time value of money of all cash flows including the initial investment. If the NPV is positive the investment will pay off. If the NPV is negative it will not.

---

## Payback and internal rate of return

A project has perpetual cash flows of $C$ per period, a cost of $I$, and a required return of $R$. What is the relationship between the project's payback and its IRR? What implications does your answer have for long-lived projects with relatively constant cash flows?

The payback period takes into account the initial investment and the cash flows to determine how long it will take to pay back the investment.

$$
\begin{aligned}
\mathbf{Payback\ Period} &= \frac{I}{C}
\end{aligned}
$$

Since the cash flows are perpetual the present value of the investment is:

$$
\begin{aligned}
\mathbf{PV} &= \frac{C}{r}
\end{aligned}
$$

Setting $\mathbf{PV} = I$, the IRR can be calculated:

$$
\begin{aligned}
I &= \frac{C}{r} \\ \\
r &= \frac{C}{I}
\end{aligned}
$$

Comparing the payback period and the IRR, we can see there is an inverse relationship between the two:

$$
\begin{aligned}
\mathbf{Payback\ Period} &= \frac{1}{IRR} \\ \\
\mathbf{IRR} &= \frac{1}{\text{Payback Period}}
\end{aligned}
$$

What this means is that a short payback period implies a high IRR because cash flows quickly recover the initial investment and continue generating value. Conversely, a long payback period implies a low IRR because the initial investment takes more time to be recovered.

---

## International investment projects

In October 2010, BMW announced plans to spend \$1 billion to expand production at its plant in South Carolina. The plant produced the second generation BMW X3 as well as the company's X5 and X6 models. BMW apparently felt it would be better able to compete and create value with a U.S.-based facility. In fact, BMW actually expected to export 70 percent of the X3s produced in South Carolina. About the same time, Samsung Electronics announced plans to build a \$3.6 billion plant in Taxes, and Novartis announced plans to open a \$1 billion-plus plant in North Carolina. What are some of the reasons that foreign manufacturers of products as diverse as automobiles, electronics, and pharmaceuticals might arrive at the same conclusion to build plants in the U.S.?

There are many reasons why foreign manufacturers would want to build plants in the U.S.:

1. The U.S. is one of the largest consumer markets in the world. To have a manufacturing plant in the U.S. gives them direct access to this market.
2. Producing goods in the U.S. may offer the manufacturer export opportunity benefits they wouldn't have in their host country.
3. Producing goods in the U.S. allows the manufacturer to avoid tariffs and trade barriers.
4. The U.S. has one of the most skilled and educated workforce in the world. Building a plant in the U.S. gives them access to this workforce.

This is by no means an exhaustive list but are some examples as to why foreign manufacturers would build plants in the U.S. to produce their products.

--

## Capital budgeting problems

What are some of the difficulties that might come up in actual applications of the various criteria we discussed in this chapter? Which would be the easiest to implement in actual applications? The most difficult?

### Difficulties

#### Payback period

1. Ignores the time value of money.
2. Has an arbitrary cutoff period.
3. Ignores cash flows beyond the cutoff period.
4. Not a measure of profitability.

#### Discounted payback period

1. Because we now discount the relevant cash flows, discounted payback period is more complex than the original payback period.
2. Still ignores cash flows beyond the cutoff period.
3. Still has an arbitrary cutoff period.

#### Internal rate of return (IRR)

1. For projects with non-conventional cash flows, such as multiple outflows, there could be multiple IRRs or no IRR at all.
2. IRR assumes that interim cash flows are reinvested at the IRR, which may be unrealistic. NPV, by contrast, assumes reinvestment at the cost of capital.
3. IRR may give incorrect rankings when comparing mutually exclusive projects when the scale of the projects, or the timing of cash flows differ.
4. Because it is a ratio, IRR does not take into account the scale of the project.

#### Profitability index (PI)

1. Because the PI is a ratio as well, it too does not take into account the scale of the project.

#### Net present value (NPV)

1. Requires accurate estimates to be effective.
2. The net present value method is highly complex, and difficult to explain its conclusions.
3. The net present value method has a bias toward larger projects because it deals with absolute, rather than relative cash flows. Using this method may miss smaller projects with better rates of return.

#### General difficulty issues when using capital budgeting tools

1. Capital budgeting tools require accurate estimates of future cash flows, discount rates, and project life. All of these are difficult to forecast.
2. When trying to compare mutually exclusive projects, it is important to take note of the size of the projects because the ratio based capital budgeting tools do not take into account the scale of the projects. The net present value method, however, does overcome this issue.
3. Because of the issue described in (2), comparing projects in general is difficult.
4. Capital budgeting tools only focus on financial metrics. Although financial metrics should be the main focus, other factors, such as strategic alignment, environmental impact, or regulatory considerations may be overlooked.

The advantages of each of the capital budgeting tools discussed:

#### Payback period

This method is good for quick assessments, or for projects with high risk where a fast payback is important to reduce uncertainty.

#### Discounted payback period

Similar to the payback period, but for projects that need to take into account the time value of money this method should be used.

#### Net present value

This is the most accurate method and always leads to the correct decision if the estimates are accurate. Net present value is very useful for long and complex projects with predictable cash flows and where maximizing value is important. Net present value is also useful when comparing mutually exclusive projects.

#### Internal rate of return (IRR)

Very useful when comparing projects where the relative rate of return is important because it returns this rate as an easily communicable percentage.

#### Profitability index (PI)

An excellent choice when comparing mutually exclusive projects of similar scale to determine the most efficient use of resources.

---

## Capital budgeting in not-for-profit entities

Are the capital budgeting criteria discussed applicable to not-for-profit corporations? How should such entities make capital budgeting decisions? What about the U.S. government? Should it evaluate spending proposals using these techniques?

Although not-for-profit corporations, or government organizations like the U.S. government, have different goals than for-profit corporations, they still need to determine the most efficient use of limited resources. Capital budgeting techniques such as the profitability index (PI), the internal rate of return (IRR), and the net present value (NPV) are excellent choices for these tasks.

---

## Net present value

The investment in project A is \$1 million, and the investment in project B is \$2 million. Both projects have unique internal rate of return of 20 percent. Is the following statement true or false?

> For any discount rate from 0 percent to 20 percent, project B has an NPV twice as great as that of project A.

This statement is true.

$$
\begin{aligned}
\mathbf{NPV} &= \sum^{T}_{t=1}{\frac{C_t}{(1 + r)^{t}}} - I
\end{aligned}
$$

where:

* $C_t =$ cash flow at period $t$.
* $r =$ the discount rate.
* $I =$ the initial investment.

Since both have the same IRR, their cash flow structure are proportional to their respective initial investments. Since the cash flows are proportional to the investments, then the cash inflows of project B are twice the cash inflows of project A.

---

## Net present value versus profitability index

Consider the following two mutually exclusive projects available to Global Investments, Inc.:

```{r Table for concepts 9, echo=F}
profitability.index <- function(C, r) {
  I <- head(C,1)
  C <- tail(C,-1)
  n <- length(C)
  pv <- sum(C/(1 + r)^(1:n))
  -pv/I
}
npv <- function(C, r){
  n <- length(C)-1
  sum(C/(1 + r)^(0:n))
}
A <- c(-1000, 1000, 500)
B <- c(-500, 500, 400)
c9.tb <- as.data.frame(matrix(c(A, round(profitability.index(A, .1), 2), round(npv(A, .1)),
                                B, round(profitability.index(B, .1), 2), round(npv(B, .1))),
                              nrow=2, byrow=T))
rownames(c9.tb) <- c("A", "B")
colnames(c9.tb) <- c("C0", "C1", "C2", "PI", "NPV")
knitr::kable(c9.tb)
```

The appropriate rate for the projects is 10 percent. Global Investments chose to undertake Project A. At a luncheon for shareholders, the manager of a pension fund that owns a substantial amount of the firm's stock asks you why the firm chose Project A instead of Project B when Project B has a higher profitability index.

How would you, the CFO, justify your firm's action? Are there any circumstances under which Global Investments should choose Project B?

Although project B has a higher profitability index rating, Project A has a higher net present value. Net present value evaluates the absolute value of the projects where as the profitability index evaluates the financial efficiency of a project (how much "bang" for your buck). The profitability index is not useful when comparing two projects of different scale because it doesn't take into account the absolute values of the projects value.

---

## Internal rate of return

Projects $A$ and $B$ have the following cash flows:

```{r Table for concept 10, echo=F}
Year <- c(0,1,2,3)
A <- c(-1000, "C1A", "C2A", "C3A")
B <- c(-2000, "C1B", "C2B", "C3B")
c10.df <- as.data.frame(matrix(c(Year,A,B),ncol=3))
colnames(c10.df) <- c("Year", "Project A", "Project B")
knitr::kable(c10.df)
```

a. If the cash flows from the projects are identical, which of the two projects would have a higher IRR? Why?
b. If C1B = 2C1A, C2B = 2C2A, and C3B = 2C3A, then is $\text{IRR}_A = \text{IRR}_B$?

IRR analysis:

$$
\begin{aligned}
\mathbf{NPV} &= -I + \sum^T_{t=1}{\frac{C}{(1 + R)^{t}}}
\end{aligned}
$$

To find the internal rate of return we choose an arbitrary rate and solve for $\text{NPV}$. If the value is $>0$ than we choose a new lower rate. If the rate is $<0$ then we choose a higher rate until we get $\text{NPV}=0$.

This process can be done via `R` using the `uniroot` function.


a. If the two projects have identical cash flows, then project A has the higher IRR because it has a lower initial investment.

b. If the cash flows for project B are twice the cash flows of project A, then the two projects would have the same IRR.

The reason for this result is because the IRR is a percentage that is compared to the discount rate. If the value of IRR is greater than the discount rate than we choose the project. However, the IRR is a percentage and not an aboslute value. Therefore, comparing two projects as such would most likely give us an incorrect result and we need to compare these projects using NPV.

---

## Net present value

You are evaluating Project A and Project B. Project A has a short period of future cash flows, while project B has relatively long future cash flows. Which project will be more sensitive to changes in the required return? Why?

Project B would be more sensitive to changes in the required return because its cash flows extend for a longer time period and the time value of money effects are heavier on cash flows further out into the future.

---

## Modified internal rate of return

One of the less flattering interpretations of the acronym MIRR is "meaningless internal rate of return." Why do you think this term is applied to MIRR?

1. Loss of original IRR intuition - The MIRR adjusts cash flows based on reinvestment and financing assumptions (reinvestment at a predefined borrowing costs). While these adjustments address some of the shortcomings, they result in a metric that no longer has the same intuitive connection connection to the project's cash flows.

2. Assumptions about the reinvestment rate - The MIRR assumes that all positive cash flows are reinvested at a specified reinvestment rate (the discount rate). However, this may not be the case.

3. MIRR is not a pure rate of return - The MIRR is not purely derived from the project's cash flows since it uses a discount rate.

* Lacks the intuitive appeal of IRR as a breakeven return.
* Relies heavily on assumptions about reinvestment and financing rates.
* Deviates from representing the project's intrinsic profitability.

---

## Net present value

It is sometimes stated that "the net present value approach assumes reinvestment of the intermediate cash flows at the required return." Is this claim correct? To answer, suppose you calculate the NPV of a project in the usual way. Next, suppose you do the following:

a. Calculate the future value (as of the end of the project) of all the cash flows other than the initial outlay assuming they are reinvested at the required return, producing a single future value figure for the project.
b. Calculate the NPV of the project using the single future value calculated in the previous step and the initial outlay. It is easy to verify that you will get the same NPV as in your original calculation only if you use the required return as the reinvestment rate in the previous step.

The statement that the "net present value (NPV) approach assumes reinvestment of intermediate cash flows at the required return" is not entirely accurate. The NPV method does not explicitly assume any reinvestment rate for intermediate cash flows. Instead, it discounts all cash flows back to the present at the required return (discount rate) and evaluates the net value created.

### Calculate the future value of intermediate cash flows

Suppose the project's cash flows are $C_0, C_1, C_2, \ldots, C_n$, where $C_0$ is the initial outlay (negative cash flow), and $C_1, C_2, \ldots, C_n$ are positive cash inflows.

1. To calculate the future value (FV) of all cash flows other than the initial outlay:

> * Assume each intermediate cash flow($C_t$) is reinvested at a specific rate $r$ until the end of the project.

> * The future value at time $n$ is:

$$
\begin{aligned}
\mathbf{NPV} &= - C_0 + \frac{\text{FV}}{(1 + R)^{n}}
\end{aligned}
$$

2. For this calculation to match the original NPV calculated using the standard formula:

$$
\begin{aligned}
\mathbf{NPV} &= - C_0 + \sum^n_{t=1}{\frac{C_t}{(1 + R)^t}}\text{,}
\end{aligned}
$$

the reinvestment rate $r$ in Step(a) must equal the required return $R$.

### Key Insights

* The NPV method does not explicitly assume a reinvestment rate for intermediate cash flows. It merely discounts cash flows to the present using the required return $R$.

* The equivalence between the two approaches described in the question arises only if the reinvestment rate $r$ used in Step (a) equals the required areturn $R$. This is a mathematical coincidence rather than an inherent assumption of the NPV method.

### Conclusion

The claim that the NPV approach assumes reinvestment of intermediate cash flows at the required return is misleading. The NPV method:

1. Focuses on discounting all cash flows to the present at the required return.

2. Does not explicitly account for the reinvestment of intermediate cash flows.

The equivalence described in the question arises only when the reinvestment rate matches the required return, but this is not an assumption of the NPV approach itself. Instead, the NPV method evaluates the project's value based on its cash flows and the required return, without considering reinvestment explicitly.

---

## Internal rate of return

It is sometimes stated that "the internal rate of return approach assumes reinvestment of the intermediate cash flows at the internal rate of return." Is this claim correct? To answer, suppose you calculate the IRR of a project in the usual way. Next, suppose you do the following:

a. Calculate the future value (as of the end of the project) of all the cash flows other than the initial outlay assuming they are reinvested at the IRR, producing a single future value figure for the project.

b. Calculate the IRR of the project using the single future value calculated in the previous step and the initial outlay. It is easy to verify that you will get the same IRR as in your original calculation only if you use the IRR as the reinvestment rate in the previous step.

The statement that the "internal rate of return (IRR) approach assumes reinvestment of the intermediate cash flows at the internal rate of return" is correct in a practical sense. The IRR implicitly assumes that intermediate cash flows are reinvested at the IRR itself. This is a key limitation of the IRR method and one of the reasons it is often criticized.

### Step a: Calculate the future value of intermediate cash flows

Suppose a project has cash flows $C_0, C_1, C_2, \ldots, C_n,$ where $C_0$ is the initial outlay (negative cash flow), and $C_1, C_2, \ldots, C_n$ are positive inflows. The IRR, denoted as $r$, satisfies:

$$
\begin{aligned}
\mathbf{NPV} &= - C_0 + \sum^{n}_{t=1}{\frac{C_t}{(1 + r)^{t}}} = 0
\end{aligned}
$$

1. Assume each intermediate cash flow ($C_t$) is reinvested at the IRR $r$ until the end of the project. The future value(FV) at time $n$ is:

$$
\begin{aligned}
\mathbf{FV} &= \sum^{n}_{t=1}{C_t (1 + r)^{n-t}}
\end{aligned}
$$

2. This future value represents the total value of the cash flows at the end of the project, assuming reinvestment at the IRR.

### Step b: Calculate the IRR using the future value

1. Use the future value $\text{FV}$ calculated in Step (a) and determine the IRR $r$ by solving:

$$
C_0 (1 + r)^{n} = \text{FV}
$$

2. This equation is equivalent to solving for $r$ in the original IRR calculation:

$$
0 = - C_0 + \sum^{n}_{t=1}{\frac{C_t}{(1 + r)^{t}}}
$$

3. The two IRR values will be identical only if the reinvestment rate used in Step (a) equals the IRR itself.

### Key Insights

* The IRR implicitly assumes that all intermediate cash flows are reinvested at the IRR. This is why the future value described in Step (a) aligns with the IRR calculation only when the reinvestment rate is the IRR.

* If the reinvestment rate differes from the IRR, the results of the two calculations will diverge.

### Limitations of the IRR assumption

1. Unrealistic reinvestment rate - In practice, it is unlikely that intermediate cash flows can consistently be reinvested at the project's IRR, especially if the IRR is high. This makes the IRR's implicit assumption unrealistic in many cases.

2. Alternative methods - The modified internal rate of return (MIRR) addresses this limitation by allowing for a more realistic reinvestment rate, such as the cost of capital.

### Conclusion

The claim that the IRR approach assumes reinvestment of intermediate cash flows at the IRR is correct. The equivalence in the steps provided confirms this assumption. However, this assumption is a major limitation of the IRR method, as it may not reflect reinvestment opportunities. For this reason, decision-makers often rely on NPV or MIRR to provide a more accurate assessment of a project's value.

---

# Questions and Problem

## Calculating payback period and NPV

Fuji Software, Inc., has the following mutually exclusive projects.

```{r Question 1 Table, echo=F}
year <- c(0, 1, 2, 3)
project.A <- c(-15000, 9500, 6000, 2400)
project.B <- c(-18000, 10500, 7000, 6000)
tbl.q1 <- as.data.frame(matrix(c(year,project.A,project.B), ncol=3))
colnames(tbl.q1) <- c("Year", "Project A", "Project B")
knitr::kable(tbl.q1)
```

a. Suppose Fuji's payback period cutoff is two years. Which of these two projects should be chosen?

b. Suppose Fuji uses the NPV rule to rank these two projects. Which project should be chosen if the appropriate discount rate is 15 percent?

### A

We can define the payback period:

$$
  \mathbf{V}_{\text{payback}} = C_0 + \sum^{T}_{t=1}{C_t}
$$
* $C_0$ is the initial investment and should be negative.

Using `R` we can determine which project should be chosen based on the payback period.

```{r Question 1 payback period}
payback.period <- function(C) {
  # Initial investment, if negative then make it positive.
  ifelse( C[1] < 0, C.0 <- -C[1], C.0 <- C[1])
  # Cash flows
  C <- tail(C, -1)
  # Determine when the initial investment is paid off.
  for(p in 1:length(C)){
    if (sum(C[1:p]) >= C.0)
      break
  }
  p
}
payback.period(project.A)
payback.period(project.B)
```

We would choose `Project A` because it has a shorter payback period.

### B

Using net present value.

$$
\mathbf{NPV} = C_0 + \sum^{T}_{t=1}{\frac{C_t}{(1 + r)^{t}}}
$$

```{r Question 1 net present value}
npv <- function(C, r) {
  I <- C[1]
  C <- tail(C,-1)
  I + sum(C/(1 + r)^(1:length(C)))
}
npv(project.A, .15)
npv(project.B, .15)
```

Based on net present value, you should choose project A.

---

## Calculating payback

An investment project provides cash inflows of \$840 per year for eight years. What is the project payback period if the initial cost is \$3,200? What if the initial cost is \$4,800? What if it is \$7,300?

Using `R` we can calculate the payback period by dividing the initial cost by the cash inflows:

```{r Question 2 calculating payback period}
3200/840
4800/840
7300/840
```

The last initial cost is beyond the 8 years. Therefore, it never pays back.

---

## Calculating discounted payback

An investment project has annual cash inflows of \$5,000, \$5,500, \$6,000, \$7,000, and a discount rate of 14 percent. What is the discounted payback period for these cash flows if the initial cost is \$8,000? What if the initial cost is \$12,000? What if it is \$16,000?

The discounted payback is calculated:

$$
\mathbf{Payback\ Period} = \frac{C_0}
  {\sum^{T}_{t=1}{\frac{C_t}{(1 + r)^{t}}}}
$$

Using `R` to find the answer:

```{r Question 3 calculating discounted payback}
CFs <- c(5000, 5500, 6000, 7000)
r <- .14
I <- c(8000, 12000, 16000)
discounted.payback <- function(I, CFs, r) {
  discounted.CFs <- CFs/(1 + r)^(1:length(CFs))
  for(t in 1:length(CFs)){
    if(sum(CFs[1:t]/(1 + r)^(1:t)) >= I){
      cat(t, " ")
      break
    }
    if (t == length(CFs)){
      cat(Inf, " ")
    }
  }
}
for (i in I)
  discounted.payback(i, CFs, r)
```

---

## Calculating discounted payback

An investment project costs \$15,000 and has annual cash flows of \$3,800 for six years. What is the discounted payback period if the discount rate is 0 percent? What if the discount rate is 10 percent? If it is 15 percent?

Again the payback period is found:

$$
\mathbf{Payback\ Period} = \frac{C_0}
  {\sum^{T}_{t=1}{\frac{C_t}{(1 + r)^{t}}}}
$$

```{r Question 4 discounted payback}
options(scipen=999)
R <- c(0, .1, .15)
I <- 15000
CFs <- rep(3800, 6)
discounted.payback <- function(I, CFs, r) {
  discounted.CFs <- CFs/(1 + r)^(1:length(CFs))
  for(t in 1:length(CFs)){
    if(sum(discounted.CFs[1:t]) >= I){
      cat(t, "\n")
      break
    }
    if (t == length(CFs)){
      cat(Inf, "\n")
      break
    }
  }
}

for(r in R)
    discounted.payback(I, CFs, r)
```

---

## Calculating IRR

Stone Sour, Inc., has a project with the following cash flows:

```{r question 5 table, echo=F}
year <- c(0,1,2,3)
CF <- c(-20000, 8500, 10200, 6200)
q5.tbl <- as.data.frame(matrix(c(year, CF), ncol=2))
colnames(q5.tbl) <- c("Year", "Cash Flows ($)")
knitr::kable(q5.tbl)
```

The company evaluates all projects by applying the IRR rule. If the appropriate interest rate is 9 percent, should the company accept the project?

```{r question 5 calculating IRR}
I <- CF[1]
CF <- tail(CF, -1)
f <- function(r) {
  I + sum(CF/(1 + r)^(1:length(CF)))
}
uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root
```

The internal rate of return is 12.41%. If the interest rate is 9% then Stone Sour, Inc. should accept the project.

---

## Calculating IRR

Compute the internal rate of return for the cash flows of the following two projects:

```{r question 6 table, echo=F}
year <- c(0,1,2,3)
project.A <- c(-5300, 2000, 2800, 1600)
project.B <- c(-2900, 1100, 1800, 1200)
q6.tbl <- as.data.frame(matrix(c(year, project.A, project.B), ncol=3))
colnames(q6.tbl) <- c("Year", "Project A", "Project B")
knitr::kable(q6.tbl)
```

```{r question 6 calculating IRR}
f <- function(r) {
  I + sum(CF/(1 + r)^(1:length(CF)))
}
I <- project.A[1]
CF <- tail(project.A,-1)
(irr.A <- uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root)
I <- project.B[1]
CF <- tail(project.B,-1)
(uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root)
```

---

## Calculating profitability index

Bill plans to open a self-serve grooming center in a storefront. The grooming equipment will cost \$385,000, to be paid immediately. Bill expects aftertax cash inflows of \$84,000 annually for seven years, after which he plans to scrap the equipment and retire to the beaches of Nevis. The first cash inflow occurs at the end of the first year. Assume the required return is 13 percent. What is the project's PI? Should it be accepted.

The profitability index is calculated:

$$
\begin{aligned}
\mathbf{PV}_{\text{Cash flows}} &= \sum^{7}_{t=1}{\frac{C_t}{(1 + r)^t}} \\ \\
\mathbf{Profitability\ Index} &= \frac{\text{PV}_{\text{Cash flows}}}{\text{Initial investment}}
\end{aligned}
$$

```{r question 7  calculating profitability index}
q7.cf <- rep(84000,7)
I <- 385000
r <- .13
sum(q7.cf/(1+r)^(1:length(q7.cf))) / I
```

The profitability index is 0.965 which is less than 1. The project should not be accpeted.

---

## Calculating profitability index

Suppose the following two independent investment opportunities are available to Greenplain, Inc. The appropriate discount rate is 10 percent.

```{r question 8 table, echo=F}
year <- c(0,1,2,3)
project.alpha <- c(-2300, 1200, 1100, 900)
project.beta <- c(-3900, 800, 2300, 2900)
q8.tbl <- as.data.frame(matrix(c(year, project.alpha, project.beta), ncol=3))
colnames(q8.tbl) <- c("Year", "Project Alpha", "Project Beta")
knitr::kable(q8.tbl)
```

a. Compute the profitability index for each of the two projects.

b. Which project(s) should Greenplain accept based on the profitability index rule?

```{r question 8 calculating profitability index}
r <- .1
I.alpha <- project.alpha[1]
CF.alpha <- tail(project.alpha, -1)
-sum(CF.alpha/(1+r)^(1:length(CF.alpha))) / I.alpha
I.beta <- project.beta[1]
CF.beta <- tail(project.beta, -1)
-sum(CF.beta/(1+r)^(1:length(CF.beta))) / I.beta
```

Both projects are $> 1$ therefore both should be accepted.

---

## Cash flow intuition

A project has an initial cost of $I$, has a required return of $R$, and pays $C$ annually for $N$ years.

a. Find $C$ in terms of $I$ and $N$ such that the project has a payback period just equal to its life.
b. Find $C$ in terms of $I$, $N$, and $R$ such that this is a profitable project according tot he NPV decision rule.
c. Find $C$ in terms of $I$, $N$, and $R$ such that the project has a benefit--cost ratio of 2.

$$
\begin{aligned}
\mathbf{N} &= \text{Life of the project} \\
\mathbf{I} &= \text{Initial cost} \\
\mathbf{C} &= \text{Annual cuopon} \\ \\
\mathbf{N} &= \frac{I}{C} \\ \text{ therefore,} \\ \\
C &= \frac{I}{N}
\end{aligned}
$$

To find $C$ in terms if $I$, $N$, and $R$ for a profitable project according to NPV

$$
\begin{aligned}
\mathbf{NPV} &= \text{net present value} \\
\mathbf{R} &= \text{interest rate} \\ \\
\mathbf{NPV} &= -I + \sum^{N}_{n=1}{\frac{C}{(1 + R)^{n}}} \\ \\
\text{for } \mathbf{NPV} > I, \\
\mathbf{I} &< \sum^{N}_{n=1}{\frac{C}{(1 + R)^{n}}} \\ \\
\text{ for a geometric series: } \\
\sum^{N}_{n=1}{\frac{1}{(1 + R)^{n}}} &= \frac{1 - (1 + R)^{-N}}{R} \\ \\
\text{substituting in:} \\
C \cdot \frac{1 - (1 + R)^{-N}}{R} > I \\ \\
\text{solving for C:} \\
C &= \frac{I \cdot R}{1 - (1 + R)^{-N}}
\end{aligned}
$$

For benefit--cost ratio of 2 (profitability index):

$$
\begin{aligned}
\mathbf{PI} &= \frac{C \cdot \sum^{N}_{n=1}{(1 + R)^{-n}}}{I} = 2 \\ \\
\text{therefore,} \\
C &= \frac{2 \cdot I \cdot R}{1 - (1 + R)^{-N}}
\end{aligned}
$$

---

## Problems with IRR

Suppose you are offered \$7,000 today but must make the following payments:

```{r question 10 table, echo=F}
year <- c(0,1,2,3,4)
cf <- c(7000, -3700, -2400, -1500, -1200)
q10.tbl <- as.data.frame(matrix(c(year, cf), ncol=2))
colnames(q10.tbl) <- c("Year", "Cash Flows ($)")
knitr::kable(q10.tbl)
```

a. What is the IRR of this offer?
b. If the appropriate discount rate is 10 percent, should you accept this offer?
c. If the appropriate discount rate is 20 percent, should you accept this offer?
d. What is the NPV of the offer if the appropriate discount rate is 10 percent? 20 percent?
e. Are the decisions under the NPV rule in part (d) consistent with those of the IRR?

Notice that the cash flows are opposite from the normal cash flows. I.e. There is an initial inflow followed by a series of outflows. This means that the IRR rule is inverted: (accept the project if the IRR < discount rate).

To solve this we find the IRR:

$$
\begin{aligned}
0 = I + \sum^{4}_{n=1}{\frac{C_n}{(1 + r)^{n}}}
\end{aligned}
$$
The known variables are $C_n$ and $I$. (a) So we solve for $r$:

```{r problem 10 problems with IRR}
n <- 4
I <- cf[1]
CF <- tail(cf, -1)
f <- function(r) {
  I + sum(CF/(1 + r)^(1:length(CF)))
}
uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root
```

The internal rate of return is 12.40%. If the discount rate is (b) 10% then we reject this project. If the discount rate is (c) 20% then we accept this project.

The NPV for both 10% and 20% discount rates can be computed:

```{r question 10 npv calculations}
npv(cf, .1)
npv(cf, .2)
```

If you consider the inverted IRR then it will be. However, using a standard rule it does not.

---

## NPV versus IRR

Consider the following cash flows on two mutually exclusive projects for the Bahamas Recreation Corporation (BRC). Both projects require an annual return of 14 percent.

```{r question 11 table}
year <- c(0,1,2,3)
cf.dwf <- c(-950000, 370000, 510000, 420000)
cf.nsr <- c(-1850000, 900000, 800000, 750000)
q11.tbl <- as.data.frame(matrix(c(year, cf.dwf, cf.nsr), ncol=3))
colnames(q11.tbl) <- c("Year", "Deepwater Fishing", "New Submarine Ride")
knitr::kable(q11.tbl)
```

As a financial analyst for BRC, you are asked the following questions:

a. If your decision rule is to accept the project with the greater IRR, which project should you choose?
b. Because you are fully aware of the IRR rule's scale problem, you calculate the incremental IRR for the cash flows, Based on your computation, which project should you choose?
c. To be prudent, you compute the NPV for both projects. Which project should you choose? Is it consistent with the incremental IRR rule?

```{r question 11 part(a): accept greater IRR}
irr <- function(C){
  I <- C[1]
  CF <- tail(C, -1)
  f <- function(r) I + sum(CF/(1+r)^(1:length(CF)))
  uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root
}
irr(cf.dwf)
irr(cf.nsr)
```

If the decision rule is to accept the project with the greater IRR (a), then we would choose the deepwater fishing project.

Using incremental IRR:

```{r question 11 part(b): incremental IRR}
cf.inc <- cf.nsr - cf.dwf
cf.inc
irr(cf.inc)
```

Because the incremental IRR is greater than the discount rate of 14%, we should choose the New Submarine Ride project.

The NPV (c) can be calculated for each project and the incremental:

```{r question 11 part(c): NPV}
r <- .14
npv(cf.dwf, r)
npv(cf.nsr, r)
npv(cf.inc, r)
```

The fact that both the NPV for the New Submarine Ride project and the incremental calculation are positive confirms the incremental IRR decision, which adds an additional \$10,798.46 value.

---

## Problems with profitability index

The Robb Computer Corporation is trying to choose between the following two mutually exclusive design projects:

```{r question 12 table, echo=F}
year <- c(0,1,2,3)
cf.I <- c(-30000, rep(18000, 3))
cf.II <- c(-12000, rep(7500, 3))
q12.tbl <- as.data.frame(matrix(c(year,cf.I,cf.II), ncol=3))
colnames(q12.tbl) <- c("Year", "Cash Flow (I)", "Cash Flow (II)")
knitr::kable(q12.tbl)
```

a. If the required return is 10 percent and Robb Computer applies the profitability index decision rule, which project should the firm accept?
b. If the company applies the NPV decision rule, which project should it take?
c. Explain why your answers in (a) and (b) are different.

If Robb Computer uses the (a) profitability index then, it should accept cash flow II:

```{r question 12 profitability index}
r <- .1
I <- cf.I[1]
CF <- tail(cf.I, -1)
CF.sum <- sum(CF/(1+r)^(1:length(CF)))
(PI.I <- -CF.sum/I)
I <- cf.II[1]
CF <- tail(cf.II, -1)
CF.sum <- sum(CF/(1+r)^(1:length(CF)))
(PI.II <- -CF.sum/I)
```

If Robb computer uses the (b) net present value then Robb computer should accept cash flow I:

```{r question 12 npv}
r <- .1
npv(cf.I, r)
npv(cf.II, r)
```

This is an issue with scale. (c) Notice that cash flow I is more twice the size of cash flow II in terms of initial investment and cash flows. The profitability index is a ratio of the present value of the cash flows over its initial investment. Because it is a ratio it doesn't consider scale. Net present value, on the other hand, is an absolute value and therefore does consider scale.

---

## Problems with IRR

Cutler Petroleum, Inc., is trying to evaluate a generation project with the following cash flows:

```{r question 13 table, echo=F}
year <- c(0,1,2)
cf <- c(-85000000, 125000000, -15000000)
q13.tbl <- as.data.frame(matrix(c(year, cf), ncol=2))
colnames(q13.tbl) <- c("Year", "Cash Flow")
knitr::kable(q13.tbl)
```

a. If the company requires a 10 percent return on its investments, should it accept this project? Why?
b. Compute the IRR for this project. How many IRRs are there? If you apply the IRR decision rule, should you accept the project or not? What's going on here?

The best way to analyze a project (a) is to use net present value:

```{r question 13 NPV}
npv(cf, .1)
```

The net present value is positive so we should accept the project.

However, if we want to use IRR (b) we should take issue with the fact that there is two sign changes. This means there are two IRRs which means we cannot use the IRR to analyze this proejct.

---

## Comparing investment criteria

Mario Brothers, a game manufacturer, has a new idea for an adventure game. It can market the game either as a traditional board game or as an interactive DVD, but not both. Consider the following cash flows of the two mutually exclusive projects for Mario Brothers. Assume the discount rate for Mario Brothers is 10 percent.

```{r question 14 table, echo=F}
year <- c(0,1,2,3)
bg <- c(-750, 600, 450, 120)
dvd <- c(-1800, 1300, 850, 350)
q14.tbl <- as.data.frame(matrix(c(year, bg, dvd), ncol=3))
colnames(q14.tbl) <- c("Year", "Board Game", "DVD")
knitr::kable(q14.tbl)
```

a. Based on the payback period rule, which project should be chosen?
b. Based on the NPV, which project should be chosen?
c. Based on the IRR, which project should be chosen?
d. Based on the incremental IRR,w hich porject should be chosen?

Calculating the payback period

```{r question 14(a): payback period}
payback.period <- function(C){
  cumsum.C <- cumsum(C)
  pb.idx <- which(cumsum.C >= 0)[1]
  if (pb.idx > 1){
    prior.cf <- cumsum.C[pb.idx - 1]
    current.cf <- cumsum.C[pb.idx]
    additional.time <- abs(prior.cf) / (current.cf - prior.cf)
    payback.period <- (pb.idx - 1) + additional.time - 1
  } else {
    payback.period <- pb.idx - 1
  }
  payback.period
}
payback.period(bg)
payback.period(dvd)
```

Based on the payback period rule (a), the board game should be chosen.

Calculating the NPV:

```{r question 14(b): npv}
npv(bg, .1)
npv(dvd, .1)
```

Based on the NPV rule (b), the DVD should be chosen.

Calculating the IRR:

```{r question 14(c): IRR}
irr(bg)
irr(dvd)
```

Based on the IRR rule (c), the board game should be chosen.

Calculating the incremental IRR

```{r question 14(d): incremental IRR}
cf.inc <- dvd - bg
irr(cf.inc)
```

Based on the incremental IRR rule (d) (that the incremental IRR is higher than the discount rate), The DVD should be chosen.

---

## Profitability index versus NPV

Hanmi Group, a consumer electronics conglomerate, is reviewing its annual budget in wireless technology. It is considering investments in three different technologies to develop wireless communication devices. Consider the following cash flows of the three independent projects for Hanmi. Assume the discount rate for Hanmi is 10 percent. Further, Hanmi Group has only \$20 million to invest in new projects this year.

```{r question 15 table, echo=F}
year <- c(0,1,2,3)
cdma <- c(-8, 11, 7.5, 2.5)
g4 <- c(-12,10, 25, 20)
wifi <- c(-20, 18, 32, 20)
q15.tbl <- as.data.frame(matrix(c(year, cdma, g4, wifi), ncol=4))
colnames(q15.tbl) <- c("Year", "CDMA", "G4", "Wi-Fi")
knitr::kable(q15.tbl)
```

a. Based on the profitability index decision rule, rank these investments.
b. Based on the NPV, rank these investments.
c. Based on your findings in (a) and (b), what would you recommend to the CEO of Hanmi Group and why?

The profitability index

$$
\begin{aligned}
\mathbf{PV} &= \sum^{N}_{n=1}{\frac{C_{n}}{(1 + r)^{n}}} \\
\mathbf{Profitability\ Index} &= \frac{\text{PV}}{I}
\end{aligned}
$$

```{r question 15 profitability index}
- sum(cdma[-1]/(1 + .1)^(1:length(cdma[-1]))) / cdma[1]
- sum(g4[-1]/(1 + .1)^(1:length(cdma[-1]))) / g4[1]
- sum(wifi[-1]/(1 + .1)^(1:length(wifi[-1]))) / wifi[1]
```

Based on the profitability index (a) we should choose G4.

The net present value

$$
\begin{aligned}
\mathbf{NPV} &= C_{0} + \sum^{N}_{n=1}{\frac{C_{n}}{(1 + r)^{n}}}
\end{aligned}
$$

```{r question 15 npv}
cdma[1] + sum(cdma[-1]/(1 + .1)^(1:length(cdma[-1])))
g4[1] + sum(g4[-1]/(1 + .1)^(1:length(g4[-1])))
wifi[1] + sum(wifi[-1]/(1 + .1)^(1:length(wifi[-1])))
```

Based on the net present value (b) we should choose Wi-Fi.

Because profitability index does not take into account scale, (c) we should rely on the net present value. Since we have \$20 million to invest, we should choose Wi-Fi.

---

## Comparing investment criteria

Consider the following cash flows of two mutually exclusive projects for AZ-Motorcars. Assume the discount rate for AZ-Motorcars is 10 percent.

```{r question 16 table, echo=F}
year <- c(0,1,2,3)
azm <- c(-450000, 320000, 180000, 150000)
azf <- c(-800000, 350000, 420000, 290000)
q16.tbl <- as.data.frame(matrix(c(year, azm, azf), ncol=3))
colnames(q16.tbl) <- c("Year", "AZM Mini-SUV", "AZF Full-SUV")
knitr::kable(q16.tbl)
```

a. Based on the payback period, which project should be accepted?
b. Based on the NPV, which project should be accepted?
c. Based on the IRR, which project should be accepted?
d. Based on this analysis, is incremental IRR analysis necessary? If yes, please conduct the analysis.

### Payback period

```{r question 16 payback}
payback.period <- function(C){
  cumsum.C <- cumsum(C)
  pb.idx <- which(cumsum.C >= 0)[1]
  if (pb.idx > 1){
    prior.cf <- cumsum.C[pb.idx - 1]
    current.cf <- cumsum.C[pb.idx]
    additional.time <- abs(prior.cf) / (current.cf - prior.cf)
    payback.period <- (pb.idx - 1) + additional.time - 1
  } else {
    payback.period <- pb.idx - 1
  }
  payback.period
}
payback.period(azm)
payback.period(azf)
```

Based on payback period we should choose the AZF Full-SUV.

### NPV

```{r question 16 npv}
npv <- function(C, r) {
  C[1] + sum(C[-1] / (1 + r)^(1:length(C[-1])))
}
npv(azm, .1)
npv(azf, .1)
```

Based on NPV (b), we should choose the AZM Mini-SUV.

### IRR

```{r question 16 irr}
irr <- function(C) {
  f <- function(r) C[1] + sum(C[-1]/(1+r)^(1:length(C[-1])))
  uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root
}
irr(azm)
irr(azf)
```

Based on IRR (c), we should choose AZM Mini-SUV.

### Incremental IRR

```{r question 16 incremental irr}
inc <- azf - azm
irr(inc)
```

Based on the incremental IRR (d), we should choose AZM Mini-SUV.

---

## Comparing investment criteria

The treasurer of Amaro Canned Fruits, Inc., has projected the cash flows of projects $A$, $B$, and $C$ as follows:

```{r question 17 table, echo=F}
year <- c(0,1,2)
project.A <- c(-150000, 110000, 110000)
project.B <- c(-300000, 200000, 200000)
project.C <- c(-150000, 120000,  90000)
q17.tbl <- as.data.frame(matrix(c(year, project.A, project.B, project.C), ncol=4))
colnames(q17.tbl) <- c("Year", "Project A", "Project B", "Project C")
knitr::kable(q17.tbl)
```

Suppose the relevant discount rate is 12 percent a year.

a. Compute the profitability index for each of the three projects.
b. Compute the NPV for each of the three projects.
c. Suppose these three projects are independent. Which project(s) should Amaro accept based on the profitability index rule?
d. Suppose these three projects are mutually exclusive. Which project(s) should Amaro accept based on the profitability index rule?
e. Suppose Amaro's budget for these projects is \$450,000. The projects are not divisible. Which project(s) should Amaro accept?

To calculate the profitability index (a) for each of these projects:

$$
\begin{aligned}
\mathbf{I} &= \text{initial investment} \\
\mathbf{C} &= \sum^{N}_{n=1}{\frac{C_{n}}{(1 + r)^{n}}} \\ \\
\mathbf{Profitability\ Index} &= \frac{C}{I}
\end{aligned}
$$

```{r question 17 profitability index of each project}
profitability.index(project.A, .12)
profitability.index(project.B, .12)
profitability.index(project.C, .12)
```

To calculate the NPV (b) for each project:

$$
\begin{aligned}
\mathbf{NPV} &= C_0 + \sum^{N}_{n=1}{\frac{C_n}{(1 + r)^{n}}}
\end{aligned}
$$

```{r question 17 NPV for each project}
npv(project.A, .12)
npv(project.B, .12)
npv(project.C, .12)
```

Based on the profitability rule, if the three projects are independent (c), then we should choose all three of the projects. If the projects are mutually exclusive (c), meaning we can only choose one of them, then we should choose project A. If Amaro Canned Fruits has \$450,000 to spend (d) on these three projects then the firm should choose projects A and C.

---

## Comparing investment criteria

Consider the following cash flows of two mutually exclusive projects for Tokyo Rubber Company. Assume the discount rate for Tokyo Rubber Company is 10 percent.

```{r question 18 table, echo=F}
year <- c(0,1,2,3)
dry<- c(-1700000,1100000,900000,750000)
solvent <- c(-750000, 375000,600000,390000)
q18.tbl <- as.data.frame(matrix(c(year, dry, solvent), ncol=3))
colnames(q18.tbl) <- c("Year", "Dry Prepreg", "Solvent Prepreg")
knitr::kable(q18.tbl)
```

a. Based on the payback period, which project should be taken?
b. Based on the NPV, which project should be taken?
c. Based on the IRR, which project should be taken?
d. Based on this analysis, is incremental IRR analysis necessary? If yes, please conduct the analysis.

To calculate the payback period, we use `R`:

```{r question 18 payback period}
payback.period(dry)
payback.period(solvent)
```

Based on the payback period both will payback within two years, so they both can be taken. If only one can be chosen then we should choose the Solvent Prepreg project because it pays back faster.

To calculate the net present value:

```{r question 18 npv}
npv(dry, .1)
npv(solvent, .1)
```

Based on the net present value (b), you should choose the Dry Prepreg project.

```{r question 18 irr}
irr(dry)
irr(solvent)
```

Based on the internal rate of return (c), you should choose the Solvent Prepreg project.

The incremental IRR is necessary because of scale (d), to calculate the incremental IRR:

```{r question 18 incremental irr}
inc <- dry - solvent
irr(inc)
```

The incremental IRR states that you should choose the Dry Prepreg project, which matches the net present value.

---

## Comparing investment criteria

Consider two mutually exclusive new product launch projects that Nagano Golf is considering. Assume the discount rate for Nagano Golf is 15 percent.

Project A:
* Nagano NP-30.
* Professional clubs that will take an initial investment of \$550,000 at time 0.
* Next five years (Years 1--5) of sales will generate a consistent cash flow of \$185,000 per year.
* Introduction of new product at Year 6 will terminate further cash flows from this project.

Project B:
* Nagano NX-20.
* High-end amateur clubs that will take an initial investment of \$350,000 at time 0.
* Cash flows at Year 1 is \$100,000. In each subsequent year cash flow will grow at 10 percent per year.
* Introduction of new product at Year 6 will terminate further cash flows from this project.

```{r question 19 table, echo=F}
year <- c(0,1,2,3,4,5)
np.30 <- c(-550000, rep(185000, 5))
nx.20 <- c(-350000, 100000*1.1^(0:4))
q19.tbl <- as.data.frame(matrix(c(year, np.30, nx.20), ncol=3))
colnames(q19.tbl) <- c("Year", "NP-30", "NX-20")
knitr::kable(q19.tbl)
```

Please fill in the following table:

```{r question 19, new table}
cumsum(nx.20)
cumsum(np.30)
pb.nagano <- c(payback.period(np.30), payback.period(nx.20))
irr.nagano <- c(irr(np.30), irr(nx.20))
pi.nagano <- c(profitability.index(np.30, .15), profitability.index(nx.20, .15))
npv.nagano <- c(npv(np.30, .15), npv(nx.20, .15))
pb.dec <- pb.nagano[1] < pb.nagano[2]
irr.dec <- irr.nagano[1] > irr.nagano[2]
pi.dec <- pi.nagano[1] > pi.nagano[2]
npv.dec <- npv.nagano[1] > npv.nagano[2]
decisions <- c(pb.dec, irr.dec, pi.dec, npv.dec)
q19.tbl.sol <- as.data.frame(matrix(c(pb.nagano, irr.nagano, pi.nagano, npv.nagano), ncol=2, byrow=T))
q19.tbl.sol <- cbind(q19.tbl.sol, decisions)
colnames(q19.tbl.sol) <- c("NP-30", "NX-20", "Choose NP-30?")
rownames(q19.tbl.sol) <- c("Payback", "IRR", "PI", "NPV")
knitr::kable(q19.tbl.sol)
```

---

