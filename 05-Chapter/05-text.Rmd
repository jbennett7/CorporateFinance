---
title: "Chapter 5"
subtitle: "Net Present Value and Other Investment Rules"
author: "Ross, Westerfield, Jaffe"
output:
  pdf_document:
    toc: true
    includes:
      in_header: preamble.tex
---

```{r setup, include=F}
require(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
pretty <- function(x, y=0) format(round(x, y), big.mark=",")
```

```{r Internal Rate of Return function, echo=F}
# I must be a negative initial investment.
# C must be positive cash flows.
irr <- function(I, C) {
  f <- function(r) I + sum(C/(1+r)^(1:length(C)))
  uniroot(f, lower=1e-5, upper=1, tol=1e-8)$root
}
```

```{r Net present value, echo=F}
npv <- function(I, C, r) I + sum(C/(1 + r)^(1:length(C)))
```

# 5.1 Why use net present value?

\begin{tcolorbox}[title=\textbf{Capital budgeting},
    colback=red!5!white, colframe=red!75!white]
The decision-making process for accepting or rejecting projects.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Net present value},
    colback=red!5!white, colframe=red!75!white]
The value of future cash flows minus the present value of the cost of the
investment.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Example 5.1},
    colback=blue!5!white, colframe=blue!75!white]
\textbf{Net Present Value}
The Alpha Corporation is considering investing in a riskless project costing
\$100. The project receives \$107 in one year and has no other cash flows. The
riskless discount rate is 6 percent.
\\\\
The NPV of the project can easily be calculated as:
\[
\$.94 = -\$100 + \frac{\$107}{1.06}
\]
From Chapter 4, we know that th eproject should be accepted because its NPV is
positive. Had the NPV of the project been negative, as would have been the case
with an interest rate greater than 7 percent, the project should be rejected.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{NPV investment rule},
    colback=orange!5!white, colframe=orange!75!white]
\begin{itemize}
  \item Accept a project if the NPV is greater than zero.
  \item Reject a project if NPT is less than zero.
\end{itemize}
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{NPV attributes},
    colback=orange!5!white, colframe=orange!70!white]
\begin{enumerate}
  \item NPV uses cash flows.
  \item NPV uses all the cash flows of the project.
  \item NPV discounts the cash flows properly.
\end{enumerate}
\end{tcolorbox}


# 5.2 The payback period method

The payback period rule for making investment decisions is simple. A particular
cutoff date, say two years, is selected. All investment projects that have
payback periods of two years or less are accepted, and all of those that pay off
in more than two years are rejected.

\begin{tcolorbox}[title=\textbf{Payback period example},
    colback=blue!5!white, colframe=blue!75!white]
Suppose a project has an initial investment of -\$50,000. The cash flows are
\$30,000, \$20,000, and \$10,000. If we choose a cutoff of two years, then the
project pays off in two years and thus we should accept the project.
\end{tcolorbox}

## Problems with the payback method

```{r Table 5.1; expected cash flows for projects, echo=F}
Year <- c(0, 1, 2, 3, 4)
A <- c(-100, 20, 30, 50, 60)
B <- c(-100, 50, 30, 20, 60)
C <- c(-100, 50, 30, 20, 60000)
knitr::kable(data.frame(Year, A, B, C),
    caption='Expected cash flows for projects A through C ($)')
```

\begin{tcolorbox}[
    title=\textbf{Problem 1: Timing of cash flows within the payback period},
    colback=orange!5!white, colframe=orange!75!white]
The payback method does not discount cash flows properly. In the table above, we
can see that all three projects have the same payback period of three years.
Therefore, all three would be identical if we use the payback period method of
choosing projects. However, because the large cash flow of \$50 comes earlier
for projects B and C, we know that those projects have a higher net present
value.
\end{tcolorbox}

\begin{tcolorbox}[
    title=\textbf{Problem 2: Payments after the payback period},
    colback=orange!5!white, colframe=orange!75!white]
Considering projects B and C we notice that project C has a rather large cash
flow in year 4 of \$60,000. However, if we used payback period, this cash flow
would not be included.
\end{tcolorbox}

\begin{tcolorbox}[
    title=\textbf{Problem 3: Arbitrary standard for payback period},
    colback=orange!5!white, colframe=orange!75!white]
There is no guide for choosing the payback cutoff date. It is completely
arbitrary.
\end{tcolorbox}

# 5.3 The discounted payback period

As an alternative we can use the discounted payback period method which does
discount the cash flows.

\begin{tcolorbox}[title=\textbf{Discounted payback period},
    colback=blue!5!white, colframe=blue!75!white]
Suppose that the discount rate is 10 percent and the cash flows on a project are
given by:

\[
(-\$100, \$50, \$50, \$20)
\]

This investment has a payback period of two years because the investment is paid
back in that time.
\\\\

To compute the project's discounted payback period, we first discount each of
the cash flows at the 10 percent rate. These discounted cash flows are:

\[
[-\$100, \$50/1.1, \$50(1.1)^2, \$20/(1.1)^3] =
    (-\$100, \$45.45, \$41.32, \$15.03)
\]

The discounted payback period of the original investment is simply the payback
period for these discounted cash flows. The payback period for the discounted
cash flows is slightly less than three years because the discounted cash flows
over the three years is \$101.80 (=\$45.45 + 41.32 + 15.03). As long as the cash
flows and discounted rate are positive, the discounted payback period will never
be smaller than the payback period because discounting reduces the value of the
cash flows.
\end{tcolorbox}

# 5.4 The internal rate of return

The appeal of the internal rate of return (IRR) is that it uses a single number
to summarize the merits of a project. This number does not depend on any outside
rate.

\begin{tcolorbox}[title=\textbf{Internal rate of return},
    colback=blue!5!white, colframe=blue!75!white]
Consider a simple project (-\$100, \$110). The net present value for this
project is

$$
\text{NPV} = -\$100 + \frac{\$110}{1 + R}
$$

where $R$ is the discount rate. The IRR method is used to find $R$.
\end{tcolorbox}

We can use `R`'s `uniroot` method to find this:

```{r 5.4 IRR example}
npv <- function(r) 110/(1 + r) - 100
uniroot(npv, c(0, 1))$root
```

We find the discount rate as .10.

We say that the project's internal rate of return is 10 percent. We compare this
number with the actual discount rate.

\begin{tcolorbox}[title=\textbf{Internal rate of return acceptance criteria},
    colback=orange!5!white, colframe=orange!75!white]
Accept the project if the IRR is greater than the discount rate. Reject the
project if the IRR is less than the discount rate.
\end{tcolorbox}

# 5.5 Problems with the IRR approach

\begin{tcolorbox}[title=\textbf{Independent project},
    colback=red!5!white, colframe=red!75!white]
A project whose acceptance or rejection is independent of the acceptance or
rejection of other projects.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{mutually exclusive investments},
    colback=red!5!white, colframe=red!75!white]
When investing in one project means you cannot invest in the other project.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Problem 1: Investing or financing?},
    colback=orange!5!white, colframe=orange!75!white]
Consider a project with cash flows (\$100, -\$130). In this situation the
positive cash flow comes first, and the payout is later. This usually happens
with projects where payment is done before receiving the good or service, such
as when buying tickets to a concert.
\\\\
In this situation we reverse the rule: Accept the project when the IRR is less
than the discount rate. Reject the project when the IRR is greater than the
discount rate.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Problem 2: Mutliple rates or return},
    colback=orange!5!white, colframe=orange!75!white]
Suppose that the cash flows from the project are (-\$100, \$230, -\$132). Here
we see that there are two sign changes. This means that the project will have
two IRRs, one is 10 percent and the other is 20 percent. In order to deal with
projects that have multiple rates of return we use the modified IRR.
\end{tcolorbox}


```{r 5.5 Problems with IRR; problem 3, echo=F}
df <- matrix(c(-1, -10, 1.5, 11, .5, 1.00, .5, .10), nrow=2)
colnames(df) <- c("CF1", "CF2", "NPV", "IRR")
rownames(df) <- c("Opportunity 1", "Opportunity 2")
knitr::kable(df)
```

\begin{tcolorbox}[title=\textbf{Problem 3: The scale problem},
    colback=orange!5!white, colframe=orange!75!white]
The table above illustrates a defect with the internal rate of return. The basic
IRR rule indicates the selection of Opportunity 1 because the IRR is 50 percent.
The IRR is only 10 percent for Opportunity 2. However, the net present value
for opportunity 2 is better.
\\\\
The problem with IRR is that it ignores issues of \textit{scale}. Although Opportunity
1 has a greater IRR, the investment is much smaller.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Example 5.2},
    colback=blue!5!white, colframe=blue!75!white]
\textbf{NPV versus IRR}
Stanley Jaffe and Sherry Lansing have just purchased the rights to Corporate
Finance: The Motion Picture. They will produce this major motion picture on
either a small budget or a big budget. Here are the estimated cash flows:
\end{tcolorbox}

```{r example 5.2; NPV versus IRR; setup, echo=F}
ex5.2 <- new.env()
ex5.2$df <- data.frame(
  cf.0 = c(-10, -25),
  cf.1 = c(40, 65),
  npv = c(22, 27),
  irr = c(300, 160)
)

row.names(ex5.2$df) <- c("Small budget", "Large budget")
colnames(ex5.2$df) <- c("Cash Flow at Date 0",
                        "Cash Flow at Date 1",
                        "NPV @25%",
                        "IRR")

knitr::kable(ex5.2$df)
```

\begin{tcolorbox}[colback=blue!5!white, colframe=blue!75!white]
Because of high risk, a 25 percent discount rate is considered appropriate.
Sherry wants to adopt the large budget because the NPV is higher. Stanley wants
to adopt the small budget because the IRR is higher. Who is right?

For the reasons espoused in the previous example, NPV is correct. Hence Sherry
is right. However, Stanley is very stubborn where IRR is concerned. How can
Sherry justify the large budget to Stanley using the IRR approach?

This is where incremental IRR comes in. Sherry calculaes the incremental cash
flows from choosing the large budget instead of the small budget as follows:

\begin{table}[H]
  \centering
  \begin{tabular}{lccc}
    \toprule
    & Cash Flow at Date 0 & Cash  Flow at Date 1\\
    Incremental cash flows & -\$25 - (-10) = -\$15 & \$65 - 40 = \$25\\
    \bottomrule
  \end{tabular}
\end{table}

This chart shows that the incremental cash flows are -\$15 million at Date 0 and
\$25 million at Date 1. Sherry calculates incremental IRR as follows:

\begin{centering}
\textbf{Formula for calculating the incremental IRR:}
\[
0 = -\$15\ \text{million} + \frac{\$25\ \text{million}}{1 + \text{IRR}}
\]
\end{centering}

IRR equals 66.67 percent in this equation, implying that the incremental IRR
is 66.67 percent. Incremental IRR is the IRR on the incremental investment from
choosing the larger project instead of the small project.

In addition, we can calculate the NPV of the incremental cash flows:

\begin{centering}
\textbf{NPV of incremental cash flows:}
\end{centering}

\[
-\$15\ \text{million} + \frac{\$25\ \text{million}}{1.25} = \$5\ \text{million}
\]

We know the small-budget picture would be acceptable as an independent project
because its NPV is positive. We want to know whether it is beneficial to invest
an additional \$15 million to make the large-budget picture instead of the
small-budget picture. In other words, is it beneficial to invest an additional
\$15 million to receive an additional \$25 million next year? First, our
calculations show the NPV on the incremental investment to be positive. Second,
the incremental IRR of 66.67 percent is higher than the discount rate of 25
percent. For both reasons, the incremental investment can be justified, so the
large-budget movie should be made. The second reason is what Stanley needed to
hear to be convinced.
\end{tcolorbox}

\begin{tcolorbox}[title=\textbf{Problem 4: The timing problem},
    colback=orange!5!white, colframe=orange!75!white]
Illustrated with the following example
\end{tcolorbox}

### Example 5.3

#### Mututally exclusive investments

Suppose that the Kaufold Corporation has two alternative uses for a warehouse.
It can store toxic waste containers (Investment A) or electronic equipment
(Investment B). The cash flows are as follows:

```{r example 5.3; mutually exclusive investments, echo=F}
ex5.3 <- new.env()
ex5.3$df <- matrix(pretty(c(-10000, -10000, 10000, 1000, 1000, 1000, 1000, 12000,
                     2000, 4000, 669, 751, 109, -484, 16.04, 12.94)), nrow=2)
row.names(ex5.3$df) <- c("Investment A", "Investment B")
colnames(ex5.3$df) <- c("CF 0", "CF 1", "CF 2", "CF 3",
                        "NPV @0%", "NPV @10%", "NPV @15%", "IRR")
knitr::kable(ex5.3$df)
```

We find that the NPV of Investment B is higher with low discount rates, and the
NPV of Investment A is higher with high discount rates. This is not surprising
if you look closely at the csh flow patterns. The cash flows of A occur early,
whereas the cash flows of B occur later. If we assume a high discount rate, we
favor Investment A because we are implicitly assuming that the early cash flow
(for example, \$10,000 in Year 1) can be reinvested at that rate. Because most
of Investment B's cash flows occur in Year 3, B's value is relatively high with
low discount rates.

# 5.6 The profitability index

The profitability index is the ratio of the present value of the future cash
flows _after_ initial investment divided by the amount of the initial
investment.

$$
\text{Profitability index (PI)} =
  \frac{\text{PV of cash flows subsequent to initial investment}}
       {\text{Initial investment}}
$$

### Example 5.4

#### Profitability index

Hiram Finnegan Inc. (HFI) applies a 12 percent discount rate to two investment
opportunities.

| Project | $C_0$ | $C_1$ | $C_2$ | PV @ 12% of CF | PI | NPV @12% |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| 1 | -\$20 | \$70 | \$10 | \$70.5 | 3.53 | \$50.5 |
| 2 | -\$10 | \$15 | \$10 | \$45.3 | 4.53 |   35.3 |

The profitability index for project 1 is calculated as such

$$
\$70.5 = \frac{\$70}{1.12} + \frac{\$10}{(1.12)^2}
$$

The profitability index is obtained by dividing this result by the initial
investment of \$20:

$$
3.53 = \frac{\$70.5}{\$20}
$$

## Application of the profitability index

### Independent projects

Assume that HFI's two projects are independent. According to the NPV rule, both
projects should be accepted because NPV is positive in each case. The
profitability index (PI) is greater than 1 whenever the NPV is positive. Thus,
the pI _decision rule_ is:

* Accept an independent project if PI > 1.

* Reject it if PI < 1.

### Mutually exclusive projects

Let us now assume that HFI can only accept one of its two projects. NPV analysis
says accept Project 1 because this project has the bigger NPV. 

### Capital rationing

Consider the case when the firm does not have enough capital to fund all
positive nPV projects.

# 5.7 The practice of capital budgeting

# Summary and conclusions

1. In this chapter, we covered different investment decision rules. We evaluated
   the most popular alternatives to the NPV: The payback period, the discounted
   payback period, the internal rate of return, and the profitability index. In
   doing so we learned more about the NPV.

2. While we found that the alternatives have some redeeming qualities, when all is said and done, they are not the NPV rule; for those of us in finance, that makes them decidedly second-rate.

3. Of the competitors to NPV, IRR must be ranked above payback. In fact, IRR always reaches the same decision as NPV in the normal case where the initial outflows of an independent investment project are followed only by a series of inflows.

4. We classified the flaws of IRR into two types. First, we considered the general case applying to both independent and mutually exclusive projects. There appeared to be two problems here:

> a. Some projects have cash inflows follwoed by one or more outflows. The IRR rule is inverted here: One should accept the IRR is _below_ the discount rate.
> b. Some projects have a number of changes of sign in their cash flows. Here, there are likely to be multiple internal rates of return. The practitioner must use either NPV or modified internal rate of return here.

5. Next, we considered the specific problems with the NPV for mutually exclusive projects. We showed that, due to differences in either size or timing, the project with the highest IRR need not have the highest NPV. Hence, the IRR rule should not be applied. (Of course, NPV can still be applied.)

6. We described capital rationing as the case where funds are limited to a fixed dollar amount. With capital rationing the profitability index is a useful method of adjusting the NPV.

