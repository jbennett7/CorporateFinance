---
title: "Financial Statements and Cash Flow"
author: "Ross, Westerfield, Jaffe"
header-includes:
  - \usepackage{booktabs}
output: 
  pdf_document:
   latex_engine: xelatex
   toc: true 
---

```{r setup, include=FALSE}
require(kableExtra)
require(dplyr)
knitr::opts_chunk$set(echo = TRUE)
options(scipen = 999)
pretty <- function(x) format(x, big.mark=",")
corporate.tax.rate.table <- read.csv('../Data/table_2_3.csv')
```

# 1. Building a balance sheet

Bishop, Inc., has current assets of \$5,700, net fixed assets of \$27,000,
current liabilities of \$4,400, and long-term debt of \$12,900. What is the
value of the shareholders' equity account for this firm? How much is net
working capital?

---

```{r problem 1; work, echo=F}
p1 <- new.env()
p1$current.assets <- 5700
p1$net.fixed.assets <- 27000
p1$current.liabilities <- 4400
p1$long.term.debt <- 12900
p1$assets <- p1$current.assets + p1$net.fixed.assets
p1$liabilities <- p1$current.liabilities + p1$long.term.debt
p1$shareholders.equity <- p1$assets - p1$liabilities
p1$net.working.capital <- p1$current.assets - p1$current.liabilities
```

Here you use the _accounting definition_ of the balance sheet:

$$
\text{Assets} \equiv \text{Liabilities} + \text{Stockholders' equity}
$$

Calculate assets by combining _current assets_ and _fixed assets_:

$$
\begin{aligned}
\mathbf{Assets} &= \text{Current Assets} + \text{Fixed Assets}\\
  &= `r pretty(p1$current.assets)`  + `r pretty(p1$net.fixed.assets)`\\
  &= `r pretty(p1$assets)`
\end{aligned}
$$

Calculate liabilities by combining _current liabilities_ and _long-term
liabilities_:

$$
\begin{aligned}
\mathbf{Liabilities} &= \text{Current Liabilities}
  - \text{Long-term liabilities}\\
  &= `r pretty(p1$current.liabilities)` + `r pretty(p1$long.term.debt)`\\
  &= `r pretty(p1$liabilities)`
\end{aligned}
$$

Reorder the equation to find the _shareholders equity_

$$
\begin{aligned}
\mathbf{Shareholders\ equity} &= \text{Assets} - \text{Liabilities}\\
  &= `r pretty(p1$assets)` - `r pretty(p1$liabilities)`\\
  &= `r pretty(p1$shareholders.equity)`
\end{aligned}
$$

Net working capital is current assets minus current liabilities:

$$
\begin{aligned}
\mathbf{Net\ working\ capital} &= \text{current assets}
  - \text{current liabilities}\\
  &= `r pretty(p1$current.assets)` - `r pretty(p1$current.liabilities)`\\
  &= `r pretty(p1$net.working.capital)`
\end{aligned}
$$

---

# 2. Building an income statement

Travis, Inc., has sales of \$387,000, costs of \$175,000, deprecation expense of
\$40,000, interest expense of \$21,000, and a tax rate of 35%. What is the net
income for the firm? Suppose the company paid out \$30,000 in cash dividends.
What is the addition to retained earnings?

---

```{r problem 2; work, echo=F}
p2 <- new.env()
p2$sales <- 387000
p2$costs <- 175000
p2$depreciation <- 40000
p2$interest <- 21000
p2$tax.rate <- .35
p2$dividends <- 30000
p2$income <- p2$sales - p2$costs
p2$ebit <- p2$income - p2$depreciation
p2$pretax.income <- p2$ebit - p2$interest
p2$taxes <- p2$pretax.income * p2$tax.rate
p2$net.income <- p2$pretax.income - p2$taxes
p2$retained.earnings <- p2$net.income - p2$dividends
```

Building the _income statement_ we need to find the following:

$$
\begin{aligned}
\mathbf{Income} &= \text{sales} - \text{costs}\\ 
  &= `r pretty(p2$sales)` - `r pretty(p2$costs)`\\
  &= `r pretty(p2$income)`\\\\
\mathbf{EBIT} &= \text{Income} - \text{Deprecation Expense}\\
  &= `r pretty(p2$income)` - `r pretty(p2$depreciation)`\\
  &= `r pretty(p2$ebit)`\\\\
\mathbf{Pretax\ income} &= \text{EBIT} - \text{Interest Expense}\\
  &= `r pretty(p2$ebit)` - `r pretty(p2$interest)`\\
  &= `r pretty(p2$pretax.income)`\\\\
\mathbf{Taxes} &= \text{Pretax income} \times \text{Tax Rate}\\
  &= `r pretty(p2$pretax.income)` \times `r p2$tax.rate`\\
  &= `r pretty(p2$taxes)`\\\\
\mathbf{Net\ income} &= \text{Pretax income} - \text{Taxes}\\
  &= `r pretty(p2$pretax.income)` - `r pretty(p2$taxes)`\\
  &= `r pretty(p2$net.income)`\\\\
\mathbf{Retained\ earnings} &= \text{Net Income} - \text{Dividends}\\
  &= `r pretty(p2$net.income)` - `r pretty(p2$dividends)`\\
  &= `r pretty(p2$retained.earnings)`
\end{aligned}
$$

## Conclusion

* Net income: \$`r pretty(p2$net.income)`
* Retained earnings: \$`r pretty(p2$retained.earnings)`

---

# 3. Market values and book values


Klingon Cruisers, Inc., purchased new cloaking machinery three years ago for
\$9.5 million. The machinery can be sold to the Romulans today for \$6.5
million. Klingon's current balance sheet shows net fixed assets of \$5.2
million, current liabilities of \$2.4 million, and net working capital of
\$800,000. If all the current assets were liquidated today, the company would
receive \$2.6 million in cash. What is the book value of Klingon's assets
today? What is the market value?

---

Klingon Cruisers, Inc. purchase of the cloaking machinery was three years ago
so its deprecated value is already represented in the net fix assets of the
current balance sheet. Calculating the book value of Klingon's assets and
comparing it to the market value of those assets can be done by:

```{r problem 3; work, echo=F}
p3 <- new.env()
p3$mv.cloaking <- 6.5E6
p3$net.fixed.assets <- 5.2E6
p3$current.liabilities <- 2.4E6
p3$net.working.capital <- 8E5
p3$mv.current.assets <- 2.6E6
p3$current.assets <- p3$net.working.capital + p3$current.liabilities
p3$assets <- p3$current.assets + p3$net.fixed.assets
p3$mv.assets <- p3$mv.cloaking + p3$mv.current.assets
```

## Step 1: Calculate the current assets of Klingon Cruisers Inc:

$$
\begin{aligned}
\mathbf{Current\ assets} &= \text{net working capital}
  + \text{current liabilities}\\
  &= `r pretty(p3$net.working.capital)` + `r pretty(p3$current.liabilities)`\\
  &= `r pretty(p3$current.assets)`
\end{aligned}
$$

## Step 2: Now calculate the book value of all assets:

$$
\begin{aligned}
\mathbf{Book\ value\ of\ assets} &= \text{current assets}
  + \text{net fixed assets}\\
  &= `r pretty(p3$current.assets)` + `r pretty(p3$net.fixed.assets)`\\
  &= `r pretty(p3$assets)`
\end{aligned}
$$

## Step 3: Calculate the market value of all assets.

$$
\begin{aligned}
\mathbf{Market\ value\ of\ assets} &= \text{market value of cloaking machine}
  + \text{market value of all current assets}\\
  &= `r pretty(p3$mv.cloaking)` + `r pretty(p3$mv.current.assets)`\\
  &= `r pretty(p3$mv.assets)`
\end{aligned}
$$

---

# 4. Calculating Taxes =REFACTOR=

The Locker Co. has \$273 thousand in taxable income. Using the rates from the
[tax table](#table:taxrates) in the notes, calculate the company's income taxes. What is the
average tax rate? What is the marginal tax rate?

---

```{r problem 4; work, echo=F}
p4 <- new.env()
p4$taxable.income <- 273000
p4$brackets <- c(
  round(50000 * .15),
  round((75000 - 50000) * .25),
  round((100000 - 75000) * .34),
  round((273000 - 100000) * .39))
p4$taxes <- sum(p4$brackets)
p4$avg.tax.rate <- round(p4$taxes / p4$taxable.income, 2)
p4$marginal.tax.rate <- .39
```

We use the table to sum up all the marginal tax rates:

$$
\begin{aligned}
50,000 \times 15\% &= `r pretty(p4$brackets[1])`\\
75,000 - 50,000 \times 25\% &= `r pretty(p4$brackets[2])`\\
100,000 - 75,000 \times 34\% &= `r pretty(p4$brackets[3])`\\
273,000 - 100,000 \times 39\% &= `r pretty(p4$brackets[4])`
\end{aligned}
$$

$$
\begin{aligned}
\text{Taxes} &= `r pretty(p4$brackets)`\\
  &= `r pretty(sum(p4$brackets))`\\\\
\text{Average Tax rate} &= `r p4$avg.tax.rate`\\
\text{Marginal Tax rate} &= `r p4$marginal.tax.rate`
\end{aligned}
$$

### We can calcualte the solution in `R`

The following functions will use the tax brackets from the tax rates table to
calculate income taxes and find the marginal tax rate.

```{r income tax function}
p4$income.tax <- function(income, brackets=corporate.tax.rate.table$Upper,
                       rate=corporate.tax.rate.table$Tax.Rate){
  sum(diff(c(0, pmin(income, brackets))) * rate)
}

marginal.tax.rate <- function(income, brackets=corporate.tax.rate.table$Upper,
                              rate=corporate.tax.rate.table$Tax.Rate){
  rate[income < brackets][1]*100
}
```

Using these functions we can calculate the income tax, the average tax rate and
the marginal tax rate.

```{r problem 4: income taxes}
taxable.income <- 273000
income_tax <- p4$income.tax(taxable.income)
avg.rate <- round(income_tax/taxable.income*100)
marginal <- marginal.tax.rate(taxable.income)
```

```{r problem 4: table, echo=F}
cat("Taxes paid:", income_tax)
table.p4 <- matrix(c(avg.rate, marginal), ncol=1)
rownames(table.p4) <- c("Average Tax Rate", "Marginal Tax Rate")
knitr::kable(table.p4, caption="Average and marginal tax rates (percents)")
```

---

# 5. Calculating OCF

Ranney, Inc., has sales of \$18,700, costs of \$10,300, depreciation expense of
\$1,900, and interest expense of \$1,250. If the tax rate is 40 percent, what
is the operating cash flow, or OCF?

---

```{r problem 5; work, echo=F}
p5 <- new.env()
p5$sales <- 18700
p5$costs <- 10300
p5$depreciation <- 1900
p5$interest <- 1250
p5$tax.rate <- .4
p5$income <- p5$sales - p5$costs
p5$ebit <- p5$income - p5$depreciation
p5$pretax.income <- p5$ebit - p5$interest
p5$taxes <- p5$pretax.income * p5$tax.rate
p5$net.income <- p5$pretax.income - p5$taxes
p5$operating.cash.flow <- p5$ebit + p5$depreciation - p5$taxes
```

## Calculating operating Cash Flow:

$$
\begin{aligned}
\mathbf{Income} &= \text{sales} - \text{cost}\\
  &= `r pretty(p5$sales)` - `r pretty(p5$costs)`\\
  &= `r pretty(p5$income)`\\\\
\mathbf{EBIT} &= \text{income} - \text{deprecation}\\
  &= `r pretty(p5$income)` - `r pretty(p5$depreciation)`\\
  &= `r pretty(p5$ebit)`\\\\
\mathbf{Income} &= \text{EBIT} - \text{interest}\\
  &= `r pretty(p5$ebit)` - `r pretty(p5$interest)`\\
  &= `r pretty(p5$income)`\\\\
\mathbf{Taxes} &= \text{income} \times \text{tax rate}\\
  &= `r pretty(p5$income)` \times `r p5$tax.rate`\\
  &= `r pretty(p5$taxes)`\\\\
\mathbf{Net\ Income} &= \text{income} - \text{taxes}\\
  &= `r pretty(p5$income)` - `r pretty(p5$taxes)`\\
  &= `r pretty(p5$net.income)`\\\\
\mathbf{Operating\ cash\ flow} &= \text{EBIT} + \text{depreciation}
  - \text{taxes}\\
  &= `r pretty(p5$ebit)` + `r pretty(p5$depreciation)` -
     `r pretty(p5$taxes)`\\
  &= `r pretty(p5$operating.cash.flow)`
\end{aligned}
$$

---

# 6. Calculate Net Capital Spending

Gordon Driving School's 2011 balance sheet showed net fixed assets of \$1.42
million, and the 2012 balance sheet showed net fixed assets of \$1.69 million.
The company's 2012 income statement showed a depreciation expense of \$145,000.
What was Gordon's net capital spending for 2012?

---

```{r problem 6; work, echo=F}
p6 <- new.env()
p6$net.fixed.assets <- c(1.42E6, 1.69E6)
p6$depreciation <- 145000
p6$net.capital.spending <- diff(p6$net.fixed.assets) + p6$depreciation
```

Net capital spending is is also called _changes in fixed assets_. The net change
in fixed assets equals the acquisition of fixed assets minus the sales of fixed
assets. However, net capital spending can also be calculated as such:

$$
\begin{aligned}
\mathbf{Capital\ spending} &= \text{ending net fixed assets}
  - \text{beginning net fixed assets} + \text{depreciation} \\
  &= `r pretty(p6$net.fixed.assets[2])`
  - `r pretty(p6$net.fixed.assets[1])` + `r pretty(p6$depreciation)`\\
  &= `r pretty(p6$net.capital.spending)`
\end{aligned}
$$

---

# 7. Building a Balance Sheet

The following table presents the long-term liabilities and stockholders' equity
of Information Control Corp. one year ago:

```{r problem 7; table, echo=F}
p7 <- new.env()
p7$bs <- matrix(c(65E6, 4E6, 15E6, 135E6, 45E6), ncol=1)
rownames(p7$bs) <- c("Long-term debt", "Preferred stock", "Common stock ($1 par value)",
                "Accumulated retained earnings", "Capital Surplus")
colnames(p7$bs) <- c("")
knitr::kable(pretty(p7$bs))
```

During the past year, Information Control issued 10 million shares of new stock
at a total price of \$58 million, and issued \$35 million in new long-term
debt. The company generated \$9 million in net income and paid \$2 million in
dividends. Construct the current balance sheet reflecting the changes that
occurred at Information Control Corp. during the year.

---

```{r problem 7; work, echo=F}
p7$issued.equity.par.value.total <- 10E6
p7$issued.equity.price <- 58E6
p7$issued.lt.debt <- 35E6
p7$net.income <- 9E6
p7$dividends <- 2E6
p7$updated.bs <- matrix(c(
    p7$bs["Long-term debt",] + p7$issued.lt.debt,
    p7$bs["Preferred stock",],
    p7$bs["Common stock ($1 par value)",] + p7$issued.equity.par.value.total,
    p7$bs["Accumulated retained earnings",] + p7$net.income - p7$dividends,
    p7$bs["Capital Surplus",] + p7$issued.equity.price
    - p7$issued.equity.par.value.total), ncol=1)
rownames(p7$updated.bs) <- rownames(p7$bs)
```

Updating the balance sheet:

$$
\begin{aligned}
\mathbf{Long\ term\ debt} &= \text{New LT Debt} + \text{Previous LT Debt}\\
  &= `r pretty(p7$bs["Long-term debt",])` + `r pretty(p7$issued.lt.debt)`\\
  &= `r pretty(p7$updated.bs["Long-term debt",])`\\\\
\mathbf{Preferred\ stock}\ \text{(no change)}
  &= `r pretty(p7$updated.bs["Preferred stock",])`\\\\
\mathbf{Common\ stock (\$1\ par\ value)} &= \text{Previous common stock}
  + \text{Newly issued stock (par value)}\\
  &= `r pretty(p7$bs["Common stock ($1 par value)",])`
  +  `r pretty(p7$updated.bs["Common stock ($1 par value)",])`\\
  &= `r pretty(p7$updated.bs["Common stock ($1 par value)",])`\\\\
\mathbf{Accumulated\ retained\ earnings} &=
  \text{Previous accumulated retained earnings} + \text{net income}\\
  &\ \ \ - \text{dividends paid}\\
  &= `r pretty(p7$bs["Accumulated retained earnings",])` +
     `r pretty(p7$net.income)` - `r pretty(p7$dividends)`\\
  &= `r pretty(p7$updated.bs["Accumulated retained earnings",])`\\\\
\mathbf{Capital\ surplus} &= \text{Previous capital surplus}
  + \text{Value of shares sold above par value}\\
  &= `r pretty(p7$bs["Capital Surplus",])`
  +  (`r pretty(p7$issued.equity.price)`
  - `r pretty(p7$issued.equity.par.value.total)`)\\
  &= `r pretty(p7$updated.bs["Capital Surplus",])`
\end{aligned}
$$

Note that capital surplus, also called additional paid-in capital (APIC),
represents the amount investors paid above the par value of the stock when it
was issued.

```{r problem 7; updated balance sheet, echo=F}
knitr::kable(pretty(p7$updated.bs), caption="Updated balance sheet")
```

---

# 8. Cash Flow to Creditors

The 2011 balance sheet of Anna's Tennis Shop, Inc., showed long-term debt of
\$1.45 million, and the 2012 balance sheet showed long-term debt of \$1.52
million. The 2012 income statement showed an interest expense of \$127,000.
What was the firm's cash flow to creditors during 2012?

---

```{r problem 8; work, echo=F}
p8 <- new.env()
p8$long.term.debt <- c(1.45E6, 1.52E6)
p8$interest.expense <- 1.27E5
p8$cf.creditors <- p8$interest.expense - diff(p8$long.term.debt)
```

$$
\begin{aligned}
\mathbf{Cash\ Flow\ to\ Creditors\ (CFC)} &= \text{interest expense}
  - (\text{ending long-term debt} - \text{beginning long-term debt})\\
  &= `r pretty(p8$interest.expense)` - (`r pretty(p8$long.term.debt[2])`
  - `r pretty(p8$long.term.debt[1])`)\\
  &= `r pretty(p8$cf.creditors)`
\end{aligned}
$$

---

# 9. Cash Flow to Stockholders

The 2011 balance sheet of Anna's Tennis Shop, Inc., showed \$490,000 in the
common stock account and \$3.4 million in the additional paid-in surplus
account. The 2012 balance sheet showed \$525,000 and \$3.7 million in the same
two accounts, respectively. If the company paid out \$275,000 in cash dividends
during 2012, what was the cash flow to stockholders for the year?

---

```{r problem 9; given, echo=F}
p9 <- new.env()
p9$bs <- matrix(
  c(4.9E5, 3.4E6, 5.25E5, 3.7E6), ncol=2)
rownames(p9$bs) <- c("Common Stock", "Additional Paid-in Surplus")
colnames(p9$bs) <- c(2011, 2012)
p9$dividends <- 2.75E5
p9$cf.stockholders <- p9$dividends - (sum(p9$bs[,2]) - sum(p9$bs[,1]))
```

$$
\begin{aligned}
\mathbf{Cash\ Flow\ to\ Stockholders\ (CFS)} &= \text{dividends}
    - (\text{Ending Equity} - \text{Beginning Equity}) \\
  &= `r pretty(p9$dividends)`
  - \left[(`r pretty(p9$bs[1,2])` + `r pretty(p9$bs[2,2])`)
    - (`r pretty(p9$bs[1,1])` + `r pretty(p9$bs[2,1])`)\right] \\
  &= `r pretty(p9$cf.stockholders)`
\end{aligned}
$$

---

# 10. Calculating Cash Flows

Given the information for Anna's Tennis Shop, Inc., in the previous two
problems, suppose you also know that the firm's net capital spending for 2012
was \$945,000 and that the firm reduced its net working capital investment by
\$87,000. What was the firm's 2012 operating cash flow, or OCF?

---

```{r problem 10; given, echo=F}
p10 <- new.env()
p10$net.capital.spending <- 945000
p10$delta.nwc <- -87000
p10$cffa <- p8$cf.creditors + p9$cf.stockholders
p10$ocf <- p10$cffa + p10$net.capital.spending + p10$delta.nwc
```

$$
\begin{aligned}
\mathbf{CFFA} &= \text{OCF} - \text{NCS} - \Delta \text{NWC} \\
  &= \text{CFC} + \text{CFS}\\
  &= `r pretty(p8$cf.creditors)` + `r pretty(p9$cf.stockholders)`\\
  &= `r pretty(p10$cffa)`\\\\
\mathbf{OCF} &= \text{CFFA} + \text{NCS} + \Delta \text{NWC}\\
 &= `r pretty(p10$cffa)` + `r pretty(p10$net.capital.spending)`
 + `r pretty(p10$delta.nwc)`\\
 &= `r pretty(p10$ocf)`
\end{aligned}
$$

---

# 11. Cash Flows =REFACTOR=

Ritter Corporation's accountants prepared the following financial statements for
year-end 2012:

  a. Explain the change in cash during 2012.
  b. Determine the change in net working capital in 2012.
  c. Determine the cash flow generated by the firm's assets during 2012.
  
```{r problem 11, echo=F}
p11 <- new.env()
p11$is <- matrix(c(750,565,90,95,75),ncol=1)
rownames(p11$is) <- c("Revenue", "Expenses", "Deprecation",
                                    "Net income", "Dividends")
p11$bs <- matrix(c(65, 170, 390, 625, 125, 145, 355, 625, 55, 165,
                           370, 590, 115, 140, 335, 590), ncol=2)
rownames(p11$bs) <- c("Cash", "Other current assets",
                              "Net fixed assets",
                              "Total assets", "Accounts payable",
                              "Long-term debt", "Stockholders equity",
                              "Total liabilities and equity")
colnames(p11$bs) <- c("2012", "2011")
p11$delta.cash <- diff(rev(p11$bs["Cash",]))
p11$current.assets <- c(sum(p11$bs[1:2,2]), sum(p11$bs[1:2,1]))
p11$current.liabilities <- c(p11$bs[5,2], p11$bs[5,1])
p11$nwc <- c(p11$current.assets - p11$current.liabilities)
p11$delta.nwc <- diff(p11$nwc)
knitr::kable(p11$is, caption="Income Statement 2012")
knitr::kable(p11$bs, caption="Balance Sheets December 31")
```

---

## a. Change in cash 2012

The cash balance has increased from \$55 in 2011 to \$65. This increase in cash
could result from a combination of operating, investing, and financing
activities, including cash generated from operations (net income), changes in
working capital, and any new financing or debt payments.

$$
\mathbf{Change\ in\ Cash} = `r pretty(p11$bs["Cash", 1])`
  - `r pretty(p11$bs["Cash", 2])`
  = `r pretty(p11$delta.cash)` 
$$

## b. Change in net working capital 2012

Net working capital = current assets - current liabilities.

Current assets are cash and other current assets, current liabilities is
accounts payable.

$$
\begin{aligned}
\mathbf{Change\ in\ NWC} &= \text{NWC}_{2012} - \text{NWC}_{2011}\\
  &=  `r p11$nwc[2]` - `r p11$nwc[1]`\\
  &= `r (p11$delta.nwc)`
\end{aligned}
$$

## c. The cash flow from assets:

$$
\begin{aligned}
\mathbf{CFFA} = \text{Operating Cash Flow} - \text{Net Capital Spending}
  - \text{Change in NWC} 
\end{aligned}
$$

Calculate the Operating Cash Flow

$$
\begin{aligned}
\mathbf{OCF} &= \text{New Income} + \text{Deprecation} \\
  &= `r p11$is[4,]` + `r p11$is[5,]`\\
  &= `r (p11$ocf <- p11$is[4,] + p11$is[3,])`\\
\end{aligned}
$$

Calculate Net Capital Spending

$$
\begin{aligned}
\mathbf{NCS} &= \text{Net Fixed Assets 2012} - \text{Net Fixed Assets 2011}
  + \text{Deprecation} \\
  &= `r p11$bs[3,1]` - `r p11$bs[3,2]` +
     `r p11$is[3,1]`\\
  &= `r (p11$ncs <- p11$bs[3,1] - p11$bs[3,2] +
      p11$is[3,1])`
\end{aligned}
$$


The Cash flow from assets

$$
\begin{aligned}
\mathbf{CFFA} &= \text{OCF} - \text{NCS} - \text{Change in NWC} \\
  &= `r p11$ocf` - `r p11$ncs` - `r p11$delta.nwc`\\
  &= `r p11$ocf - p11$ncs - p11$delta.nwc`
\end{aligned}
$$

---

# 12. Financial Cash Flows

The Stancil Corporation provided the following current information:

```{r problem 12; work, echo=F}
p12 <- new.env()
p12$tb <- matrix(c(17000,4000,21000,1900,14500), ncol=1)
rownames(p12$tb) <- c("Proceeds from long-term borrowing",
                      "Proceeds from the sale of common stock",
                      "Purchases of fixed assets",
                      "Purchases of inventories",
                      "Payment of dividends")
knitr::kable(pretty(p12$tb))

# Purchases of fixed assets and inventories
p12$cf.firm <- sum(p12$tb[3:4,1])

# Proceeds from sale of common stock and payment of dividends
p12$cf.investors <- p12$tb[5,1] - p12$tb[2,1]
```

Determine the cash flows from the firm and the cash flows to investors of the
firm.

---

## Cash Flows from the firm

$$
\begin{aligned}
\mathbf{Cash\ flows\ from\ the\ firm} &= \text{Purchases of fixed assets}
  + \text{Purchases of inventories} \\
  &= `r pretty(p12$tb[3,1])` + `r pretty(p12$tb[4,1])`\\
  &= `r pretty(p12$cf.firm)`
\end{aligned}
$$

## Cash Flows to investors

We only consider investors, not creditors.

$$
\begin{aligned}
\mathbf{Cash\ flows\ to\ investors}
  &= \text{Payment of dividends}
  - \text{Proceeds from the sale of common stock} \\
  &= `r pretty(p12$tb[5,1])` - `r pretty(p12$tb[2,1])`\\
  &= `r pretty(p12$cf.investors)`
\end{aligned}
$$

---

# 13. Building an Income Statement

During the year, the Senbet Discount Tire Company has gross sales of \$1.06
million. The firm's cost of goods sold and selling expenses were \$525,000 and
\$215,000, respectively. Senbet also has notes payable of \$800,000. These notes
carried an interest rate of 7 percent. Deprecation was \$130,000. Senbet's tax
rate was 35 percent.

a. What was Senbet's net income?
b. What was Senbet's operating cash flow?

---

```{r problem 13; work, echo=F}
p13 <- new.env()
p13$sales <- 1.06E6
p13$costs <- 525000
p13$selling.expenses <- 215000
p13$notes.payable <- 800000
p13$interest.rate <- .07
p13$depreciation <- 130000
p13$tax.rate <- .35
p13$income <- p13$sales - p13$costs - p13$selling.expenses
p13$ebit <- p13$income - p13$depreciation
p13$interest <- p13$notes.payable * p13$interest.rate
p13$pretax.income <- p13$ebit - p13$interest
p13$taxes <- p13$pretax.income * p13$tax.rate
p13$net.income <- p13$pretax.income - p13$taxes
p13$ocf <- p13$ebit + p13$depreciation - p13$taxes
```

## a. Net Income

$$
\begin{aligned}
\mathbf{Income} &= \text{gross sales} - \text{cost of goods sold}
  - \text{selling expenses}\\
  &= `r pretty(p13$sales)` - `r pretty(p13$costs)` -
  `r pretty(p13$selling.expenses)`\\
  &= `r pretty(p13$income)`\\\\
\mathbf{EBIT} &= \text{gross income} - \text{deprecation}\\
  &= `r pretty(p13$income)` - `r pretty(p13$depreciation)`\\
  &= `r pretty(p13$ebit)`\\\\
\mathbf{Interest\ payments} &= \text{notes payable}
  \times \text{interest rate}\\
  &= `r pretty(p13$notes.payable)` \times `r p13$interest.rate`\\
  &= `r pretty(p13$interest)`\\\\
\mathbf{Pretax\ income} &= \text{EBIT} - \text{interest payments}\\
  &= `r pretty(p13$ebit)` - `r pretty(p13$interest)`\\
  &= `r pretty(p13$pretax.income)`\\\\
\mathbf{Taxes} &= \text{pretax income} \times \text{tax rate}\\
  &= `r pretty(p13$pretax.income)` \times `r p13$tax.rate`\\
  &= `r pretty(p13$taxes)`\\\\
\mathbf{Net\ income} &= \text{pretax income} - \text{taxes}\\
  &= `r pretty(p13$pretax.income)` - `r pretty(p13$taxes)`\\
  &= `r pretty(p13$net.income)`
\end{aligned}
$$

## b. Operating Cash Flow

$$
\begin{aligned}
\mathbf{OCF} &= \text{EBIT} + \text{depreciation} - \text{taxes} \\
  &= `r pretty(p13$ebit)` + `r pretty(p13$depreciation)` -
     `r pretty(p13$taxes)`\\
  &= `r pretty(p13$ocf)`
\end{aligned}
$$

---

# 14. Calculating Total Cash Flows

Schwert Corp. shows the following information on its 2012 income statement:
sales = \$185,000; costs = \$98,000; other expenses = \$6,700; deprecation
expense = \$16,500; interest expense = \$9,000; taxes = \$19,180; dividends =
\$9,500. In addition, you're told that the firm issued \$7,550 in new equity
during 2012 and redeemed \$7,100 in outstanding long-term debt.

a. What is the 2012 operating cash flow?

b. What is the 2012 cash flow to creditors?

c. What is the 2012 cash flow to stockholders?

d. If net fixed assets increased by \$26,100 during the year, what was the
   addition to net working capital (NWC)?

---

```{r problem 14; work, echo=F}
p14 <- new.env()
p14$sales <- 185000
p14$costs <- 98000
p14$other.expenses <- 6700
p14$depreciation <- 16500
p14$interest <- 9000
p14$taxes <- 19180
p14$dividends <- 9500
p14$new.equity <- 7550
p14$redeemed.lt.debt <- 7100
p14$delta.net.fixed.assets <- 26100
p14$income <- p14$sales - p14$costs - p14$other.expenses
p14$ebit <- p14$income - p14$depreciation
p14$pretax.income <- p14$ebit - p14$interest
p14$net.income <- p14$pretax.income - p14$taxes
p14$ocf <- p14$ebit + p14$depreciation - p14$taxes
p14$cfc <- p14$interest + p14$redeemed.lt.debt
p14$cfs <- p14$dividends - p14$new.equity
p14$cffa <- p14$cfc + p14$cfs
p14$capital.spending <- p14$delta.net.fixed.assets + p14$depreciation
p14$delta.net.working.capital <- p14$ocf - p14$capital.spending - p14$cffa
```

## a. Operating cash flow for 2012

$$
\begin{aligned}
\mathbf{Gross\ income} &= \text{sales} - \text{costs} - \text{other expenses}\\
  &= `r pretty(p14$sales)` - `r pretty(p14$costs)` -
     `r pretty(p14$other.expenses)`\\
  &= `r pretty(p14$gross.income <-
     p14$sales - p14$costs - p14$other.expenses)`\\
\mathbf{OCF} &= \text{gross income} - \text{taxes}\\
  &= `r pretty(p14$gross.income)` - `r pretty(p14$taxes)`\\
  &= `r pretty(p14$ocf <- p14$gross.income - p14$taxes)`\\\\
\end{aligned}
$$

## b. Cash flow to creditors (CFC)

$$
\begin{aligned}
\mathbf{CFC} &= \text{interest expense} - \text{new net borrowing}\\
  &= `r pretty(p14$interest)` - (-`r pretty(p14$redeemed.lt.debt)`)\\
  &= `r pretty(p14$cfc <- p14$interest - (-p14$redeemed.lt.debt))`
\end{aligned}
$$

## c. Cash flow to stockholders (CFS)

$$
\begin{aligned}
\mathbf{CFS} &= \text{dividends} - \text{net new equity raised}\\
 &= `r pretty(p14$dividends)` - `r pretty(p14$new.equity)`\\
 &= `r pretty(p14$cfs <- p14$dividends - p14$new.equity)`
\end{aligned}
$$

## d. Net working capital (NWC)

With net fixed assets increased to \$`r pretty(p14$delta.net.fixed.assets <- 26100)`
during the year, the addition to net working capital is:
 
$$
\begin{aligned}
\mathbf{CFFA} &= \text{CFC} + \text{CFS}\\
  &= `r pretty(p14$cfc)` + `r pretty(p14$cfs)`\\
  &= `r pretty(p14$cffa)`\\\\
\mathbf{Net\ capital\ spending} &= \text{increase in net fixed assets}
  + \text{depreciation}\\
  &= `r pretty(p14$delta.net.fixed.assets)` + `r pretty(p14$depreciation)`\\
  &= `r pretty(p14$capital.spending)`\\\\
\mathbf{Change\ in\ NWC} &= \text{OCF} - \text{Net Capital Spending}
  - \text{CFFA}\\
  &= `r pretty(p14$ocf)` - `r pretty(p14$capital.spending)` - `r pretty(p14$cffa)`\\
  &= `r pretty(p14$delta.net.working.capital)`
\end{aligned}
$$

---

# 15. Using Income Statements

Given the following information for O'Hare Marine Co., calculate the
depreciation expense: sales = \$41,000; costs = \$26,400; addition to retained
earnings = \$4,900; dividends paid = \$1,570; interest expense = \$1,840; tax
rate = 35 percent.

---

```{r problem 15; given, echo=F}
p15 <- new.env()
p15$sales <- 41000
p15$costs <- 26400
p15$retained.earnings <- 4900
p15$dividends <- 1570
p15$interest <- 1840
p15$tax.rate <- .35
p15$net.income <- p15$retained.earnings + p15$dividends
p15$pretax.income <- round(p15$net.income / (1 - p15$tax.rate))
p15$ebit <- p15$pretax.income + p15$interest
p15$income <- p15$sales - p15$costs
p15$depreciation <- p15$income - p15$ebit
```

We need to work backwards

1. Find net income from retained earnings and dividends.
2. Find pretax income by dividing the net income by (1 - tax rate).
3. Find EBIT by adding interest to pretax income.
4. Find income from the difference between sales and costs
5. Find depreciation by subtracting EBIT from income

$$
\begin{aligned}
\mathbf{Net\ Income} &= \text{addition to retained earnings}
  + \text{dividends paid}\\
  &= `r pretty(p15$retained.earnings)` + `r pretty(p15$dividends)`\\
  &= `r pretty(p15$net.income)`\\\\
\mathbf{Pretax\ Income\ (rounded)} &= \frac{\text{net income}}
  {(1 - \text{tax rate})}\\
  &= \frac{`r pretty(p15$net.income)`}{(1 - `r p15$tax.rate`)}\\
  &\approx `r pretty(p15$pretax.income)`\\\\
\mathbf{EBIT} &= \text{Pretax income} + \text{interest paid}\\
  &= `r pretty(p15$pretax.income)` + `r pretty(p15$interest)`\\
  &= `r pretty(p15$ebit)`\\\\
\mathbf{Income} &= \text{sales} - \text{costs}\\
  &= `r pretty(p15$sales)` - `r pretty(p15$costs)`\\
  &= `r pretty(p15$income)`\\\\
\mathbf{Deprecation} &=  \text{income} - \text{EBIT}\\
  &= `r pretty(p15$income)` - `r pretty(p15$ebit)`\\
  &= `r pretty(p15$depreciation)`
\end{aligned}
$$

Depreciation expense is calculated as: \$`r pretty(p15$depreciation)`

---

# 16. Residual Claims

Huang, Inc., is obligated to pay its creditors \$10,900 very soon.

a. What is the market value of the shareholders' equity if assets have a market
   value of \$12,400?

b. What if assets equal \$9,600?

---

```{r problem 16; given, echo=F}
p16 <- new.env()
p16$creditor.obligation <- 10900
p16$mv.assets <- c(12400, 9600)
p16$shareholders.equity <- p16$mv.assets - p16$creditor.obligation
```

## a. Market value of shareholders' equity

Shareholders' equity: \$`r pretty(p16$mv.assets[1])`

$$
\begin{aligned}
\mathbf{Shareholders'\ equity} &= \text{assets market value}
  - \text{creditor obligations} \\
  &= `r pretty(p16$mv.assets[1])` - `r pretty(p16$creditor.obligation)`\\
  &= `r pretty(p16$shareholders.equity[1])`
\end{aligned}
$$

## b. Market value of shareholders' equity

Assets: \$`r pretty(p16$mv.assets[2])`

$$
\begin{aligned}
\mathbf{Shareholders'\ equity} &= \text{assets market value}
  - \text{creditor obligations} \\
  &= `r pretty(p16$mv.assets[2])` - `r pretty(p16$creditor.obligation)`\\
  &= `r pretty(p16$shareholders.equity[2])`
\end{aligned}
$$

---

# 17. Marginal versus Average Tax Rates

(Refer to the corporate tax rates table) Corporation Growth \$86,000 in taxable
income, and Corporation Income has \$8,600,000 in taxable income.

a. What is the tax bill for each firm?

b. Suppose both firms have identified a new project that will increase taxable
   income by \$10,000. How much in additional taxes will each firm pay? Why is
   this amount the same?

---

To calculate the taxes you sum up the values of all the marginal tax brackets to
the bracket the taxable income falls into. We will use the same function we
created for problem 4.

```{r problem 17; work, echo=F}
p17 <- new.env()
p17$corp.growth.taxable.income <- 86000
p17$corp.income.taxable.income <- 8600000
knitr::kable(corporate.tax.rate.table)
p17$corp.growth.taxes <- p4$income.tax(p17$corp.growth.taxable.income)
p17$corp.income.taxes <- p4$income.tax(p17$corp.income.taxable.income)
```

## a. Tax bill

We will use the `income.tax` function defined in problem 4.

The tax bill for Corporation growth is \$`r pretty(p17$corp.growth.taxes)`

The tax bill for Corporation income is \$`r pretty(p17$corp.income.taxes)`

## b. Marginal tax rates

To find the marginal tax bracket we define a new function. This function takes
an income and searches the brackets for which one the stated income is less than
or equal to the upper limit of the bracket returning the tax rate.

```{r problem 17b income.tax.bracket function}
income.tax.bracket <- function(income,
                               brackets=corporate.tax.rate.table$Upper){
  return(which(income <= brackets)[1])
}
```

We use the function to find the marginal tax bracket for both corporations with
the next \$10,000 and the tax rate for each.

```{r problem17b calculation}
p17$addition <- 10000
p17$corp.growth.b <- income.tax.bracket(p17$corp.growth.taxable.income +
                                        p17$addition)
p17$corp.income.b <- income.tax.bracket(p17$corp.income.taxable.income +
                                        p17$addition)
p17$corp.growth.t <- corporate.tax.rate.table[p17$corp.growth.b, c("Tax.Rate")]
p17$corp.income.t <- corporate.tax.rate.table[p17$corp.income.b, c("Tax.Rate")]
```

```{r problem17b output, echo=F}
p17$table <- matrix(c(p17$corp.growth.t, p17$corp.income.t,
                      p17$corp.growth.b, p17$corp.income.b), ncol=2)
rownames(p17$table) <- c("Corporation Growth", "Corporation Income")
colnames(p17$table) <- c("Tax Rate", "Tax Bracket")
knitr::kable(p17$table, caption="Marginal Tax Rates")
```

The third and fifth tax brackets tax the next \$10,000 at the same rate 34\%.

---

# 18. Net Income and OCF

During 2012, Raines Umbrella Corp. had sales of \$630,000. Costs of goods sold,
administrative and selling expenses, and depreciation expenses were \$470,000,
\$95,000, and \$140,000, respectively. In addition, the company had an interest
expense of \$70,000 and a tax rate of 35 percent. (ignore any tax loss carryback
or carry forward provisions.)

a. What is Raines's net income for 2012?
b. What is its operating cash flow?
c. Explain your results in (a) and (b).

---

```{r problem 18; given, echo=F}
p18 <- new.env()
p18$sales <- 630000
p18$cogs <- 470000
p18$admin.selling.expenses <- 95000
p18$depreciation <- 140000
p18$interest <- 70000
p18$tax.rate <- .35
p18$income <- p18$sales - p18$cogs - p18$admin.selling.expenses
p18$ebit <- p18$income - p18$depreciation
p18$pretax.income <- p18$ebit - p18$interest
# if pretax.income is negative then we pay no taxes.
p18$taxes <- round(max(p18$pretax.income, 0) * p18$tax.rate)
p18$net.income <- p18$pretax.income - p18$taxes
p18$ocf <- p18$ebit + p18$depreciation - p18$taxes
```

## a. Raines's net income for 2012


$$
\begin{aligned}
\mathbf{gross\ income} &= \text{sales} - \text{costs of goods sold}
  - \text{administrative and selling expenses} \\
  &= `r pretty(p18$sales)` - `r pretty(p18$cogs)` -
     `r pretty(p18$admin.selling.expenses)`\\
  &= `r pretty(p18$income)`\\\\
\mathbf{EBIT} &= \text{income} - \text{depreciation} \\
  &= `r pretty(p18$income)` - `r pretty(p18$depreciation)`\\
  &= `r pretty(p18$ebit)`\\\\
\mathbf{Pretax\ income} &= \text{EBIT} - \text{interest}\\
  &= `r pretty(p18$ebit)` - `r pretty(p18$interest)`\\
  &= `r pretty(p18$pretax.income)`
\end{aligned}
$$

Since pretax income is negative, Raines pays no taxes.

## b. Deprecation is added back to EBIT to get the OCF

$$
\begin{aligned}
\mathbf{OCF} &= \text{EBIT} + \text{depreciation}\\
  &= `r pretty(p18$ebit)` + `r pretty(p18$depreciation)`\\
  &= `r pretty(p18$ocf)`
\end{aligned}
$$

## c. What do the results in (a) and (b) mean?

Net income is negative due to high costs, depreciation, and interest expense
leading to a pre-tax loss. However, because depreciation is a non-cash expense,
and despite the accounting loss, the business still generated \$65,000 in cash
from operations.

---

# 19. Accounting values versus cash flows

```{r problem 19; setup, echo=F}
p19 <- new.env()
```

In problem 18, suppose Raines Umbrella Corp. paid out \$34,000 in cash
dividends. Is this possible? If spending on net fixed assets and net working
capital was zero, and if no new stock was issued during the year, what was the
change in the firm's long-term debt account?

---

```{r problem 19; given, echo=F}
p19$ocf <- p18$ocf
p19$interest <- p18$interest
p19$delta.ncs <- 0
p19$delta.nwc <- 0
p19$dividends <- 34000
p19$cfs <- p19$dividends
p19$cffa <- p19$ocf - p19$delta.ncs - p19$delta.nwc
p19$cfc <- p19$cffa - p19$cfs
p19$delta.lt.debt <- p19$cfc - p19$interest
```

Yes, since Raines Umbrella Corp. has positive operating cash flow, the company
can pay out a cash dividend of \$34,000.

We need to find the change in long-term debt.

## Approach

$$
\text{CFFA} = \text{CFC} + \text{CFS}
$$

## Step 1: Compute free cash flow (CFFA)

$$
\begin{aligned}
\mathbf{CFFA} &= \text{OCF} - \text{net capital spending}
  - \text{change in net working capital}\\
  &= `r pretty(p19$ocf)` - `r p19$delta.ncs` - `r p19$delta.nwc`\\
  &= `r pretty(p19$cffa)`
\end{aligned}
$$

## Step 2: Solve for cash flow to creditors (CFC)

$$
\begin{aligned}
\mathbf{CFC} &= \text{CFFA} - \text{CFS}\\
  &= `r pretty(p19$cffa)` - (`r p19$cfs`)\\
  &= `r pretty(p19$cfc)`
\end{aligned}
$$

The change in long-term debt can be found:

$$
\begin{aligned}
\mathbf{CFC} &= \text{interest paid} - \text{change in Long-term debt}\\
\text{change in Long-term debt} &= \text{CFC} - \text{interest paid}\\
  &= `r pretty(p19$cfc)` - `r pretty(p19$interest)`\\
  &= `r pretty(p19$delta.lt.debt)`
\end{aligned}
$$

---

# 20. Calculating cash flows

Cusic Industries had the following operating results for 2012: sales = \$19,900;
cost of goods sold = \$14,200; deprecation expense = \$2,700; interest expense =
\$670; dividends paid = \$650. At the beginning of the year, net fixed assets
were \$15,340, current assets were \$4,420, and current liabilities were
\$2,470. At the end of the year, net fixed assets were \$16,770, current assets
were \$5,135, and current liabilities were \$2,535. The tax rate for 2012 was 40
percent.

a. What is net income for 2012?

b. What is the operating cash flow for 2012?

c. What is the cash flow from assets from 2012? Is this possible? Explain.

d. If no new debt was issued during the year, what is the cash flow to
creditors? What is the cash flow to stockholders? Explain and interpret the
positive and negative signs of your answers in (a) through (d).

---

```{r problem 20; given, echo=F}
p20 <- new.env()
p20$sales <- 19900
p20$cogs <- 14200
p20$depreciation <- 2700
p20$interest <- 670
p20$dividends <- 650
p20$net.fixed.assets <- c(15340, 16770)
p20$current.assets <- c(4420, 5135)
p20$current.liabilities <- c(2470, 2535)
# c(current.assets, current.liabilities)
p20$current.beginning <- c(4420, 2470)
p20$current.ending <- c(5135, 2535)
p20$tax.rate <- .4
p20$income <- p20$sales - p20$cogs
p20$ebit <- p20$income - p20$depreciation
p20$pretax.income <- p20$ebit - p20$interest
p20$taxes <- round(p20$pretax.income * p20$tax.rate, 2)
p20$net.income <- p20$pretax.income - p20$taxes
p20$ocf <- p20$ebit + p20$depreciation - p20$taxes
p20$delta.ncs <- diff(p20$net.fixed.assets)
p20$delta.nwc <- diff(rev(p20$current.ending)) - diff(rev(p20$current.beginning))
p20$cffa <- p20$ocf - p20$delta.ncs - p20$delta.nwc
p20$cfc <- p20$interest
p20$cfs <- p20$cffa - p20$cfc
```

## a. Calculating net income

$$
\begin{aligned}
\mathbf{Income} &= \text{sales} - \text{cost of goods sold}\\
  &= `r pretty(p20$sales)` - `r pretty(p20$cogs)`\\
  &= `r pretty(p20$income)`\\\\
\mathbf{EBIT} &=  \text{Income} - \text{depreciation}\\
  &= `r pretty(p20$income)` - `r pretty(p20$depreciation)`\\
  &= `r pretty(p20$ebit)`\\\\
\mathbf{Pretax\ income} &= \text{EBIT} - \text{interest}\\
  &= `r pretty(p20$ebit)` - `r pretty(p20$interest)`\\
  &= `r pretty(p20$pretax.income)`\\\\
\mathbf{Taxes} &= \text{Pretax income} \times \text{tax rate}\\
  &= `r pretty(p20$pretax.income)` \times `r p20$tax.rate`\\
  &= `r pretty(p20$taxes)`\\\\
\mathbf{Net\ Income} &= \text{Pretax income} - \text{Taxes}\\
  &= `r pretty(p20$pretax.income)` - `r pretty(p20$taxes)`\\
  &= `r pretty(p20$net.income)`
\end{aligned}
$$

## b. The operating cash flow

$$
\begin{aligned}
\mathbf{OCF} &= \text{EBIT} + \text{depreciation} - \text{taxes}\\
  &= `r pretty(p20$ebit)` + `r pretty(p20$depreciation)`
     - `r pretty(p20$taxes)`\\
  &= `r pretty(p20$ocf)`
\end{aligned}
$$

## c. The cash flow from assets (CFFA)

$$
\begin{aligned}
\mathbf{CFFA} &= \text{OCF} - \text{change in capital spending}
  - \text{change in net working capital}
\end{aligned}
$$

$$
\begin{aligned}
\mathbf{Change\ in\ capital\ spending} &= \text{net fixed assets end of year}
 - \text{net fixed assets beginning of year}\\
   &= `r pretty(p20$net.fixed.assets[2])` -
      `r pretty(p20$net.fixed.assets[1])`\\
   &= `r pretty(p20$delta.ncs)`
\end{aligned}
$$

$$
\begin{aligned}
\mathbf{Change\ in\ net\ working\ capital} &=
    \text{net working capital end of year}
  - \text{net working capital beginning of year}\\
  &= (`r pretty(p20$current.ending[1])` - `r pretty(p20$current.ending[2])`)
   - (`r pretty(p20$current.beginning[1])` - `r pretty(p20$current.beginning[2])`)\\
  &= `r pretty(p20$delta.nwc)`
\end{aligned}
$$

$$
\begin{aligned}
\mathbf{CFFA} &= \text{OCF} - \text{net capital spending}
  + \text{change in net working capital}\\
  &= `r pretty(p20$ocf)` - `r pretty(p20$delta.ncs)` - `r pretty(p20$delta.nwc)`\\
  &= `r pretty(p20$cffa)`
\end{aligned}
$$

Yes, this positive CFFA is possible--it indicates the firm generated more cash
from its operations than it invested in assets and working capital.

## d. Cash flow to creditors and stockholders

$$
\begin{aligned}
\mathbf{CFC} &= \text{interest paid} - \text{net new borrowing}\\
  &= `r pretty(p20$interest)` - 0\\
  &= `r pretty(p20$cfc)`
\end{aligned}
$$

$$
\begin{aligned}
\mathbf{CFS} &= \text{CFFA} - \text{dividends paid}
  + \text{net new equity raised}\\
  &= `r pretty(p20$cffa)` - `r pretty(p20$cfc)`\\
  &= `r pretty(p20$cfs)`
\end{aligned}
$$

Alternatively

$$
\begin{aligned}
\mathbf{CFS} &= \text{dividends paid} - \text{net new equity}
\end{aligned}
$$

However, we are not told what the net new equity is. We can assume that
the \$`r pretty(p20$cfs)` cash flow to stockholders includes
\$`r pretty(p20$dividends)` dividends and
\$`r pretty(p20$cfs - p20$dividends)` of stock repurchases.

---

# 21. Calculating cash flows

Consider the following abbreviated financial statements for Weston Enterprises:

a. What is owners' equity for 2011 and 2012?
b. What is the change in net working capital for 2012?
c. In 2012, Weston Enterprises purchased \$2,160 in new fixed assets. How much in fixed assets did Weston Enterprises sell? What is the cash flow from assets for the year? (The tax rate is 40 percent.)
d. During 2012, Weston Enterprises raised \$432 in new long-term debt. How much long-term debt must Weston Enterprises have paid off during the year? What is the cash flow to creditors?

```{r problem 21; balance sheet, echo=F}
p21 <- new.env()
# Assets for balance sheet
p21$bs.assets <- matrix(c(936,4176,1015,4896), ncol=2)
rownames(p21$bs.assets) <- c("Current assets", "Net fixed assets")
colnames(p21$bs.assets) <- c("2011", "2012")
# Liabilities for balance sheet
p21$bs.liabilities <- matrix(c(382,2160,416,2477), ncol=2)
rownames(p21$bs.liabilities) <- c("Current liabilities", "Long-term debt")
colnames(p21$bs.liabilities) <- c("2011", "2012")
# Balance sheet
p21$balance.sheet <- list( pretty(p21$bs.assets), pretty(p21$bs.liabilities))
knitr::kable(p21$balance.sheet,
  caption="Weston Enterprises 2011 and 2012 parital balance sheet") %>%
  kable_styling(latex_options = "striped") %>%
  kable_styling(latex_options = "HOLD_position")
```

```{r problem 21; income statement, echo=F}
# Income Statement 2012
p21$income.statement.2012 <- matrix(c(12380, 5776, 1150, 314), ncol=1)
rownames(p21$income.statement.2012) <- c("Sales", "Costs", "Deprecation",
                                         "Interest paid")
knitr::kable(pretty(p21$income.statement.2012),
  caption="Weston Enterprises 2012 Income Statement") %>%
  kable_styling(latex_options = "striped") %>%
  kable_styling(latex_options = "HOLD_position")

# c(2011, 2012)
p21$assets <- c(sum(p21$bs.assets[,1]), sum(p21$bs.assets[,2]))
p21$liabilities <- c(sum(p21$bs.liabilities[,1]), sum(p21$bs.liabilities[,2]))
p21$shareholders.equity <- c(p21$bs.assets[1] - p21$bs.liabilities[1],
                             p21$bs.assets[2] - p21$bs.liabilities[2])
p21$nwc <- c(p21$bs.assets[1,1] - p21$bs.liabilities[1,1],
             p21$bs.assets[1,2] - p21$bs.liabilities[1,2])
p21$delta.nwc <- diff(p21$nwc)
p21$new.fixed.assets <- 2160
p21$tax.rate <- .4
p21$depreciation <- as.numeric(p21$income.statement.2012[3,1])
p21$interest <- as.numeric(p21$income.statement.2012[4,1])
p21$delta.net.fixed.assets <- as.numeric(diff(p21$bs.assets[2,]))
p21$sold.fixed.assets <- p21$new.fixed.assets - p21$delta.net.fixed.assets -
  p21$depreciation
p21$income <- as.numeric(diff(rev(p21$income.statement.2012[1:2,1])))
p21$ebit <- p21$income - p21$depreciation
p21$pretax.income <- p21$ebit - p21$interest
p21$taxes <- p21$pretax.income * p21$tax.rate
p21$net.income <- p21$pretax.income - p21$taxes
p21$ocf <- p21$ebit + p21$depreciation - p21$taxes
p21$cffa <- p21$ocf - p21$delta.net.fixed.assets - p21$delta.nwc
p21$lt.debt <- c(2160, 2477)
p21$new.lt.debt <- 432
p21$delta.lt.debt <- as.numeric(diff(p21$bs.liabilities[2,1:2]))
p21$retired.lt.debt <- p21$new.lt.debt - p21$delta.lt.debt
p21$cfc <- p21$interest + p21$retired.lt.debt
```

---

## a. Calculating the owners' equity for 2011 and 2012.

Shareholders' Equity = Assets - Liabilities

$$
\begin{aligned}
\text{2011 Assets} &= `r pretty(p21$assets[1])`\\
\text{2012 Assets} &= `r pretty(p21$assets[2])`\\
\text{2011 Liabilities} &= `r pretty(p21$liabilities[1])`\\
\text{2012 Liabilities} &= `r pretty(p21$liabilities[2])`\\
\text{2011 Shareholders' equity} &= `r pretty(p21$shareholders.equity[1])`\\
\text{2012 Shareholders' equity} &= `r pretty(p21$shareholders.equity[2])`\\
\end{aligned}
$$

## b. Change in net working capital for 2012

net working capital = current assets - current liabilities

$$
\begin{aligned}
\text{2011 net working capital} &= `r pretty(p21$nwc[1])`\\
\text{2012 net working capital} &= `r pretty(p21$nwc[2])`\\
\text{2012 change in NWC} &= `r pretty(p21$delta.nwc)`
\end{aligned}
$$

## c. Fixed assets and Cash flow from assets (CFFA)

$$
\begin{aligned}
\text{Sold fixed assets} &= \text{Bought fixed assets}
  - \text{Change in fixed assets} - \text{Depreciation}\\
  &= `r pretty(p21$new.fixed.assets)`
  - `r pretty(p21$delta.net.fixed.assets)`
  - `r pretty(p21$income.statement.2012[3,1])`\\
  &= `r pretty(p21$sold.fixed.assets)`\\
\end{aligned}
$$

$$
\text{CFFA} = \text{OCF} - \text{NCS} - \Delta \text{NWC}
$$

$$
\begin{aligned}
\text{Income} &= \text{sales} - \text{costs}\\
  &= `r pretty(as.numeric(p21$income.statement.2012[1,1]))`
  -  `r pretty(as.numeric(p21$income.statement.2012[2,1]))`\\
  &= `r pretty(p21$income)`\\\\
\text{EBIT} &= \text{income} - \text{depreciation}\\
  &= `r pretty(p21$income)` - `r pretty(p21$depreciation)`\\
  &= `r pretty(p21$ebit)`\\\\
\text{Pretax income} &= \text{EBIT} - \text{interest}\\
  &= `r pretty(p21$ebit)` - `r pretty(p21$interest)`\\
  &= `r pretty(p21$pretax.income)`\\\\
\text{Taxes} &= \text{pretax income} \times \text{tax rate (40\%)}\\
  &= `r pretty(p21$pretax.income)` \times `r p21$tax.rate`\\
  &= `r pretty(p21$taxes)`\\\\
\text{Net income} &= \text{pretax income} - \text{taxes}\\
  &= `r pretty(p21$pretax.income)` - `r pretty(p21$taxes)`\\
  &= `r pretty(p21$net.income)`\\\\
\text{OCF} &= \text{EBIT} + \text{depreciation} - \text{taxes}\\
  &= `r pretty(p21$ebit)` + `r pretty(p21$depreciation)`
  -  `r pretty(p21$taxes)`\\
  &= `r pretty(p21$ocf)`\\\\
\text{CFFA} &= \text{OCF} - \text{NCS} - \Delta \text{NWC}\\
  &= `r pretty(p21$ocf)` - `r pretty(p21$delta.net.fixed.assets)`
  -  `r pretty(p21$delta.nwc)`\\
  &= `r pretty(p21$cffa <- p21$ocf - p21$delta.net.fixed.assets -
               p21$delta.nwc)`
\end{aligned}
$$

## d. Changes in Long-term debt and cash flow to creditors

$$
\begin{aligned}
\text{2012 New long-term debt} &= `r pretty(p21$new.lt.debt <- 432)`\\
\text{2012 LT Debt} &= `r pretty(p21$lt.debt[2])`\\
\text{2011 LT Debt} &= `r pretty(p21$lt.debt[1])`\\
\text{2012 Paid off debt} &= `r pretty(p21$retired.lt.debt)`\\\\
\text{CFC} &= \text{Interest} + \text{Retired debt}\\
  &= `r pretty(p21$interest)` + `r pretty(p21$retired.lt.debt)`\\
  &= `r pretty(p21$cfc)`
\end{aligned}
$$

---

# Information for problems 22 and 23

```{r Ingersoll problems 22 and 23, echo=F}
p22 <- new.env()
p22$y2011 <- c(7835, 1125, 2696, 639, 525, 4109, 5439,
               794, 13460, 34455, 4316, 9670, 956)
p22$y2012 <- c(8409, 1126, 3060, 534, 603, 5203, 6127,
               746, 16050, 35277, 4185, 9938, 1051)
p22$ingersoll <- matrix( c(p22$y2011, p22$y2012), ncol=2)
colnames(p22$ingersoll) <- c("2011", "2012")
rownames(p22$ingersoll) <- c("Sales", "Depreciation", "Cost of goods sold",
                               "Other expenses", "Interest", "Cash",
                               "Accounts receivable", "Short-term notes payable",
                               "Long-term debt", "Net fixed assets",
                               "Accounts payable", "Inventory", "Dividends")
knitr::kable(p22$ingersoll)
p22$tax.rate <- .34
```

---

# 22. Financial Statements

Draw up an income statement and balance sheet for the company for 2011 and 2012.

---

## Income statement

```{r problem 22 income statement, echo=F}
p22$income.statement.headings <- c(
  "Sales",
  "Cost of goods sold",
  "Other expenses",
  "Depreciation",
  "EBIT",
  "Interest expense",
  "Pretax income",
  "Taxes",
  "Net income",
  "Addition to retained earnings",
  "Dividends"
)
# 2011
# EBIT = sales - cogs - other - depreciation
p22$sales <- as.numeric(p22$ingersoll["Sales",])
p22$cogs <- as.numeric(p22$ingersoll["Cost of goods sold",])
p22$other.expenses <- as.numeric(p22$ingersoll["Other expenses",])
p22$income <- p22$sales - p22$cogs - p22$other.expenses
p22$depreciation <- as.numeric(p22$ingersoll["Depreciation",])
p22$ebit <- p22$income - p22$depreciation
p22$interest <- as.numeric(p22$ingersoll["Interest",])
p22$pretax.income <- p22$ebit - p22$interest
p22$taxes <- p22$pretax.income * p22$tax.rate
p22$net.income <- p22$pretax.income - p22$taxes
p22$dividends <- as.numeric(p22$ingersoll["Dividends",])
p22$addition.to.retained.earnings <- p22$net.income - p22$dividends
p22$income.statement <- matrix(c(p22$sales[2], p22$cogs[2],
  p22$other.expenses[2], p22$depreciation[2], p22$ebit[2], p22$interest[2],
  p22$pretax.income[2], p22$taxes[2], p22$net.income[2],
  p22$addition.to.retained.earnings[1], p22$dividends[1], p22$sales[1],
  p22$cogs[1], p22$other.expenses[1], p22$depreciation[1], p22$ebit[1],
  p22$interest[1], p22$pretax.income[1], p22$taxes[1], p22$net.income[1],
  p22$addition.to.retained.earnings[1], p22$dividends[1]), ncol=2)
rownames(p22$income.statement) <- p22$income.statement.headings
colnames(p22$income.statement) <- c("2012", "2011")
knitr::kable(pretty(p22$income.statement),
    caption="Ingersoll, Inc. Income Statement") %>%
  kable_styling(latex_options = "striped") %>%
  kable_styling(latex_options = "HOLD_position")
```

## Balance Sheet

```{r problem 22, echo=F}
p22$bs.columns <- c("2012", "2011")
p22$current.assets <-
    p22$ingersoll[c("Cash", "Accounts receivable", "Inventory"),]
p22$ca.rownames <- rownames(p22$current.assets)
p22$current.assets <- rbind(p22$current.assets, colSums(p22$current.assets))
rownames(p22$current.assets) <-
    c(p22$ca.rownames, "Total current assets")
p22$fixed.assets <- p22$ingersoll[c("Net fixed assets"),,drop=F]
p22$total.assets <-
    as.numeric(p22$current.assets["Total current assets",] + p22$fixed.assets)
p22$bs.assets <- rbind(p22$current.assets, p22$fixed.assets, p22$total.assets)
rownames(p22$bs.assets) <-
    c(rownames(p22$current.assets), rownames(p22$fixed.assets), "Total assets")

p22$current.liabilities <-
    p22$ingersoll[c("Short-term notes payable", "Accounts payable"),]
p22$cl.rownames <- rownames(p22$current.liabilities)
p22$current.liabilities <-
    rbind(p22$current.liabilities, colSums(p22$current.liabilities))
rownames(p22$current.liabilities) <-
    c(p22$cl.rownames, "Total current liabilities")
p22$lt.liabilities <- p22$ingersoll[c("Long-term debt"),,drop=F]
p22$total.liabilities <-
    as.numeric(p22$current.liabilities["Total current liabilities",] +
               p22$lt.liabilities)
p22$shareholders.equity <- p22$total.assets - p22$total.liabilities
p22$bs.liabilities.she <-
    rbind(p22$current.liabilities, p22$lt.liabilities,
          p22$total.liabilities, p22$shareholders.equity,
          p22$shareholders.equity + p22$total.liabilities)
rownames(p22$bs.liabilities.she) <-
    c(rownames(p22$current.liabilities), rownames(p22$lt.liabilities),
      "Total liabilities", "Shareholders' equity",
      "Total liabilities and Shareholders' equity")
p22$bs.display <- list(pretty(p22$bs.assets[,p22$bs.columns]),
                       pretty(p22$bs.liabilities.she[,p22$bs.columns]))
knitr::kable(p22$bs.display,
             caption="Ingersoll Inc., Balance Sheet") %>%
  kable_styling(latex_options = "striped") %>%
  kable_styling(latex_options = "HOLD_position")
```

---

# 23. Calculating Cash Flow

For 2012, calculate the cash flow from assets, cash flow to creditors, and cash flow to stockholders.

---

```{r problem 23, echo=F}
p22$y2012 <- p22$income.statement[,"2012"]
p22$ocf <- p22$y2012["EBIT"] + p22$y2012["Depreciation"] - p22$y2012["Taxes"]
p22$net.capital.spending <- diff(p22$bs.assets["Net fixed assets",]) +
    p22$y2012["Depreciation"]
p22$delta.nwc <- diff(as.numeric(p22$bs.assets["Total current assets",] -
                      p22$bs.liabilities.she["Total current liabilities",]))
p22$cffa <- p22$ocf - p22$net.capital.spending - p22$delta.nwc
p22$cfc <- as.numeric(p22$y2012["Interest expense"]) -
    diff(as.numeric(p22$bs.liabilities.she["Long-term debt",]))
p22$cfs <- p22$cffa - p22$cfc
```

$$
\begin{aligned}
\text{OCF} &= \text{EBIT} + \text{Depreciation} - \text{Taxes}\\
  &= `r pretty(p22$y2012["EBIT"])` + `r pretty(p22$y2012["Depreciation"])` -
     `r pretty(p22$y2012["Taxes"])`\\
  &= `r pretty(p22$ocf)`\\\\
\text{NCS} &= \text{Change in fixed assets} + \text{Depreciation}\\
  &= `r pretty(p22$bs.assets["Net fixed assets","2012"])`
  -  `r pretty(p22$bs.assets["Net fixed assets","2011"])`
  +  `r pretty(p22$y2012["Depreciation"])`\\
  &= `r pretty(p22$net.capital.spending)`\\\\
\Delta \text{NWC} &= \text{Change in net working capital}\\
  &= (`r pretty(p22$bs.assets["Total current assets", "2012"])` 
  -   `r pretty(p22$bs.liabilities.she["Total current liabilities", "2012"])`)
  -  (`r pretty(p22$bs.assets["Total current assets", "2011"])` 
  -   `r pretty(p22$bs.liabilities.she["Total current liabilities", "2011"])`)\\
  &= `r pretty(p22$delta.nwc)`\\\\
\text{CFFA} &= \text{OCF} - \text{NCS} - \Delta \text{NWC}\\
  &= `r pretty(p22$ocf)` - `r pretty(p22$net.capital.spending)`
  -  `r pretty(p22$delta.nwc)`\\
  &= `r pretty(p22$cffa)`\\\\
\text{CFC} &= \text{Interest} - \text{change in long term debt}\\
  &= `r pretty(p22$y2012["Interest expense"])` -
      (`r pretty(p22$bs.liabilities.she["Long-term debt", "2012"])` -
       `r pretty(p22$bs.liabilities.she["Long-term debt", "2011"])`)\\
  &= `r pretty(p22$cfc)`\\\\
\text{CFS} &= \text{CFFA} - \text{CFC}\\
  &= `r pretty(p22$cffa)` - (`r pretty(p22$cfc)`)\\
  &= `r pretty(p22$cfs)`
\end{aligned}
$$

---

# 24. Cash Flows

You are researching Time Manufacturing and have found the following accounting
statement of cash flows for the most recent year. You also know that the company
paid \$98 million in current taxes and had an interest expense of \$48 million.
Use the accounting statement of cash flows to construct the financial statement
of cash flows.

```{r problem 24 time manufacturing statement of cash flows, echo=F}
p24 <- new.env()
 ## net income, deprecation, deferred taxes
p24$operations <- c(173, 94, 19)
 ## changes in assets and liabilities: accounts receivable, inventories,
 ### accounts payable, accrued expenses, other
p24$changes.in.assets.and.liabilities <- c(-18, 22, 17, -9, 3)
 ## acquisition of fixed assets, sale of fixed assets
p24$investing.activities <- c(-215, 23)
 ## retirement of long-term debt, proceeds from long-term debt sales,
 ### changes in notes payable, dividends, repurchase of stock,
 ### proceeds from new stock issue
p24$financing.activities <- c(-162, 116, 6, -86, -13, 44)
p24$statement.of.cash.flows <- matrix(c(
  p24$operations,
  p24$changes.in.assets.and.liabilities,
  p24$investing.activities,
  p24$financing.activities), ncol=1)
rownames(p24$statement.of.cash.flows) <- c(
  "Net income", "Depreciation", "Deferred taxes", "Changes in Accounts receivable",
  "Changes in Inventories", "Changes in Accounts payable",
  "Changes in Accrued expenses", "Changes in Other expenses",
  "Acquisition of fixed assets", "Sale of fixed assets",
  "Retirement of long-term debt", "Proceeds from long-term debt sales",
  "Change in notes payable", "Dividends", "Repurchase of stock",
  "Proceeds from new stock issue"
)
knitr::kable(p24$statement.of.cash.flows,
             booktabs=T,
             caption="Time Manufacturing Inc.: Statement of Cash Flows") %>%
  pack_rows( index=c(
    "Operations" = 8,
    "Investing activities" = 2,
    "Financing activities" = 6
  )) %>%
  kable_styling(latex_options = "striped")
```

---

```{r problem 24; work, echo=F}
p24$current.taxes <- 98
p24$deferred.taxes <- 19
p24$taxes <- sum(p24$current.taxes, p24$deferred.taxes)
p24$interest <- 48
p24$socf <- p24$statement.of.cash.flows
p24$ebit <- p24$socf["Net income",] + p24$interest + p24$taxes
p24$ocf <- as.numeric(p24$ebit + p24$socf["Depreciation",] + p24$current.taxes)
p24$net.capital.spending <-
    -as.numeric(p24$socf["Acquisition of fixed assets",]) -
     as.numeric(p24$socf["Sale of fixed assets",])
p24$delta.nwc <-
    sum(as.numeric(p24$socf[c("Changes in Accounts receivable",
                              "Changes in Inventories"),])) -
    sum(as.numeric(p24$socf[c("Changes in Accounts payable",
                              "Changes in Accrued expenses",
                              "Changes in Other expenses",
                              "Change in notes payable"),]))
p24$cffa <- p24$ocf - p24$net.capital.spending - p24$delta.nwc
p24$cfc <- p24$interest -
    as.numeric(p24$socf["Proceeds from long-term debt sales",]) +
    as.numeric(- p24$socf["Retirement of long-term debt",])
p24$cfs <- -as.numeric(p24$socf["Dividends",]) -
    as.numeric(p24$socf["Proceeds from new stock issue",]) -
    as.numeric(p24$socf["Repurchase of stock",])
```

knowing net income (\$173), taxes (\$117), and interest (\$48), we observe:

$$
\begin{aligned}
\mathbf{EBIT} &= \text{net income} + \text{interest} + \text{taxes}\\
  &= `r pretty(p24$socf["Net income"])` + `r pretty(p24$interest)`
  +  `r pretty(p24$taxes)`\\
  &= `r pretty(p24$ebit)`\\\\
\mathbf{OCF} &= \text{EBIT} + \text{depreciation} - \text{current taxes}\\
  &= `r pretty(p24$ebit)` + `r pretty(p24$socf["Depreciation",])`
  -  `r pretty(p24$current.taxes)`\\
  &= `r pretty(p24$ocf)`\\\\
\mathbf{Capital\ spending} &= \text{sale of fixed assets}
  - \text{acquisition of fixed assets}\\
  &= `r pretty(-p24$investing.activities[1])`
  -  `r pretty(p24$investing.activities[2])`\\
  &= `r pretty(p24$ncs <- -p24$investing.activities[1] -
      p24$investing.activities[2])`\\\\
\Delta \mathbf{NWC} &=
  \text{Changes in assets and liabilities}\\
  &= `r pretty(p24$delta.nwc)`\\\\
\mathbf{CFFA} &= \text{OCF} - \text{net capital spending}
  -  \Delta \text{NWC}\\
  &= `r pretty(p24$ocf)` - `r pretty(p24$ncs)` - (`r pretty(p24$delta.nwc)`)\\
  &= `r pretty(p24$cffa)`\\\\
\mathbf{CFC} &= \text{interest expense}
  - \text{Proceeds from long-term debt sales}
  + \text{Retirement of long-term debt}\\
  &= `r pretty(p24$interest)` - 
     `r pretty(p24$socf["Proceeds from long-term debt sales",])` +
     `r pretty(- p24$socf["Retirement of long-term debt",])`\\
  &= `r pretty(p24$cfc)`\\\\
\mathbf{CFS} &= \text{dividends paid}
  -  \text{Proceeds from new stock issue}
  +  \text{Repurchase of stock}\\
  &= `r pretty(- p24$socf["Dividends",])`
   - `r pretty(p24$socf["Proceeds from new stock issue",])`
   + `r pretty(- p24$socf["Repurchase of stock",])`\\
  &= `r pretty(p24$cfs)`
\end{aligned}
$$

---

# 25. Net Fixed Assets and Deprecation

On the balance sheet, the net fixed assets (NFA) account is equal to the gross
fixed assets (FA) account, which records the acquisition cost of fixed assets,
minus the accumulated deprecation (AD) account, which records the total
deprecation taken by the firm against its fixed assets. Using the fact that NFA
= FA - AD, show that the expression given in the chapter for net capital
spending, $\text{NFA}_{\text{end}} - \text{NFA}_{\text{beg}} + D$ (where D is
the depreciation expense during the year), is equivalent to
$\text{FA}_{\text{end}} - \text{FA}_{\text{beg}}$.

---

## Terms:

* NFA - Net Fixed Assets
* FA - Gross Fixed Assets
* AD - Accumulated Depreciation
* D - Depreciation

## Given:

$$
\begin{aligned}
\mathbf{NFA} = \text{FA} - \text{AD}
\end{aligned}
$$

Then
$$
\begin{aligned}
\mathbf{FA} = \text{NFA} + \text{AD}
\end{aligned}
$$
The accumulated depreciation is the sum of the depreciations each year up until the current year:

$$
\begin{aligned}
\mathbf{AD} = \sum_{\text{year}=0}^{\text{current year}}{D_{\text{year}}}
\end{aligned}
$$

Therefore:

$$
\begin{aligned}
\text{NFA}_{\text{end}} - \text{NFA}_{\text{beg}} + D &= 
    \text{FA}_{\text{end}} - \text{FA}_{\text{beg}} \\
\Delta \text{NFA} + D &= \Delta \text{FA} \\ \\
\text{NFA} + D &= \text{FA}
\end{aligned}
$$

---

# 26. Tax Rates

Refer to the corporate marginal tax rate information in Table 2.3.

a. Why do you think the marginal tax rate jumps up from 34 percent to 39 percent at a taxable income of \$100,001, and then falls back to a 34 percent marginal rate at a taxable income of \$335,001?

b. Compute the average tax rate for a corporation with exactly \$335,001 in taxable income. Does this confirm your explanation in part (a)? What is the average tax rate for a corporation with exactly \$18,333,334? Is the same thing happening here?

c. The 39 percent and 38 percent tax rates both represent what is called a tax "bubble." Suppose the government wanted to lower the upper threshold of the 39 percent marginal tax bracket from \$335,000 to \$200,000. What would the new 39 percent bubble rate have to be?

---
